,url,repository_url,labels_url,comments_url,events_url,html_url,id,node_id,number,title,user,labels,state,locked,assignee,assignees,milestone,comments,created_at,updated_at,closed_at,author_association,active_lock_reason,draft,pull_request,body,reactions,timeline_url,performed_via_github_app,state_reason
0,https://api.github.com/repos/pandas-dev/pandas/issues/57241,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57241/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57241/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57241/events,https://github.com/pandas-dev/pandas/pull/57241,2116847445,PR_kwDOAA0YD85l7yjQ,57241,"DEPR: Remove sql.execute, *args/**kwargs in resample, unrecognized timezones","{'login': 'mroeschke', 'id': 10647082, 'node_id': 'MDQ6VXNlcjEwNjQ3MDgy', 'avatar_url': 'https://avatars.githubusercontent.com/u/10647082?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/mroeschke', 'html_url': 'https://github.com/mroeschke', 'followers_url': 'https://api.github.com/users/mroeschke/followers', 'following_url': 'https://api.github.com/users/mroeschke/following{/other_user}', 'gists_url': 'https://api.github.com/users/mroeschke/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/mroeschke/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/mroeschke/subscriptions', 'organizations_url': 'https://api.github.com/users/mroeschke/orgs', 'repos_url': 'https://api.github.com/users/mroeschke/repos', 'events_url': 'https://api.github.com/users/mroeschke/events{/privacy}', 'received_events_url': 'https://api.github.com/users/mroeschke/received_events', 'type': 'User', 'site_admin': False}","[{'id': 211029535, 'node_id': 'MDU6TGFiZWwyMTEwMjk1MzU=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Clean', 'name': 'Clean', 'color': '207de5', 'default': False, 'description': None}]",open,False,,[],"{'url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/102', 'html_url': 'https://github.com/pandas-dev/pandas/milestone/102', 'labels_url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/102/labels', 'id': 9021906, 'node_id': 'MI_kwDOAA0YD84AianS', 'number': 102, 'title': '3.0', 'description': '', 'creator': {'login': 'jbrockmendel', 'id': 8078968, 'node_id': 'MDQ6VXNlcjgwNzg5Njg=', 'avatar_url': 'https://avatars.githubusercontent.com/u/8078968?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jbrockmendel', 'html_url': 'https://github.com/jbrockmendel', 'followers_url': 'https://api.github.com/users/jbrockmendel/followers', 'following_url': 'https://api.github.com/users/jbrockmendel/following{/other_user}', 'gists_url': 'https://api.github.com/users/jbrockmendel/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jbrockmendel/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jbrockmendel/subscriptions', 'organizations_url': 'https://api.github.com/users/jbrockmendel/orgs', 'repos_url': 'https://api.github.com/users/jbrockmendel/repos', 'events_url': 'https://api.github.com/users/jbrockmendel/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jbrockmendel/received_events', 'type': 'User', 'site_admin': False}, 'open_issues': 45, 'closed_issues': 150, 'state': 'open', 'created_at': '2023-02-08T18:16:49Z', 'updated_at': '2024-02-04T03:07:01Z', 'due_on': '2024-04-01T07:00:00Z', 'closed_at': None}",0,2024-02-04T03:07:01Z,2024-02-04T03:07:02Z,,MEMBER,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/57241', 'html_url': 'https://github.com/pandas-dev/pandas/pull/57241', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/57241.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/57241.patch', 'merged_at': None}",,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57241/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57241/timeline,,
1,https://api.github.com/repos/pandas-dev/pandas/issues/57239,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57239/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57239/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57239/events,https://github.com/pandas-dev/pandas/pull/57239,2116792327,PR_kwDOAA0YD85l7mRn,57239,DOC: fix PR02 errors in docstring for pandas.Series.rename_axis,"{'login': 'jordan-d-murphy', 'id': 35613487, 'node_id': 'MDQ6VXNlcjM1NjEzNDg3', 'avatar_url': 'https://avatars.githubusercontent.com/u/35613487?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jordan-d-murphy', 'html_url': 'https://github.com/jordan-d-murphy', 'followers_url': 'https://api.github.com/users/jordan-d-murphy/followers', 'following_url': 'https://api.github.com/users/jordan-d-murphy/following{/other_user}', 'gists_url': 'https://api.github.com/users/jordan-d-murphy/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jordan-d-murphy/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jordan-d-murphy/subscriptions', 'organizations_url': 'https://api.github.com/users/jordan-d-murphy/orgs', 'repos_url': 'https://api.github.com/users/jordan-d-murphy/repos', 'events_url': 'https://api.github.com/users/jordan-d-murphy/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jordan-d-murphy/received_events', 'type': 'User', 'site_admin': False}","[{'id': 134699, 'node_id': 'MDU6TGFiZWwxMzQ2OTk=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Docs', 'name': 'Docs', 'color': '3465A4', 'default': False, 'description': None}]",open,False,,[],,0,2024-02-04T01:19:50Z,2024-02-04T03:09:58Z,,CONTRIBUTOR,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/57239', 'html_url': 'https://github.com/pandas-dev/pandas/pull/57239', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/57239.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/57239.patch', 'merged_at': None}","All PR02 Errors resolved in the following cases:



OUTPUT:

1. scripts/validate_docstrings.py --format=actions --errors=PR02 pandas.Series.rename_axis
```
################################################################################
################################## Validation ##################################
################################################################################

1 Errors found for `pandas.Series.rename_axis`:
	ES01	No extended summary found
```


- [x] xref https://github.com/pandas-dev/pandas/issues/57111
- [x] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [x] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
- [ ] Added [type annotations](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#type-hints) to new arguments/methods/functions.
- [ ] Added an entry in the latest `doc/source/whatsnew/vX.X.X.rst` file if fixing a bug or adding a new feature.
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57239/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57239/timeline,,
2,https://api.github.com/repos/pandas-dev/pandas/issues/57236,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57236/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57236/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57236/events,https://github.com/pandas-dev/pandas/pull/57236,2116744441,PR_kwDOAA0YD85l7beW,57236,DOC: Clarifying brackets vs. parentheses,"{'login': 'noah-asing', 'id': 7989798, 'node_id': 'MDQ6VXNlcjc5ODk3OTg=', 'avatar_url': 'https://avatars.githubusercontent.com/u/7989798?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/noah-asing', 'html_url': 'https://github.com/noah-asing', 'followers_url': 'https://api.github.com/users/noah-asing/followers', 'following_url': 'https://api.github.com/users/noah-asing/following{/other_user}', 'gists_url': 'https://api.github.com/users/noah-asing/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/noah-asing/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/noah-asing/subscriptions', 'organizations_url': 'https://api.github.com/users/noah-asing/orgs', 'repos_url': 'https://api.github.com/users/noah-asing/repos', 'events_url': 'https://api.github.com/users/noah-asing/events{/privacy}', 'received_events_url': 'https://api.github.com/users/noah-asing/received_events', 'type': 'User', 'site_admin': False}",[],open,False,,[],,0,2024-02-04T00:05:26Z,2024-02-04T00:05:26Z,,NONE,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/57236', 'html_url': 'https://github.com/pandas-dev/pandas/pull/57236', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/57236.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/57236.patch', 'merged_at': None}","- [x] closes #56972
- [ ] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit). (Doc edits only)
- [ ] Added [type annotations](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#type-hints) to new arguments/methods/functions. (Doc edits only)
- [ ] Added an entry in the latest `doc/source/whatsnew/vX.X.X.rst` file if fixing a bug or adding a new feature. (Doc edits only)

In addition to the clarification requested in #56972, I adjusted the language where square brackets were specified elsewhere in the documentation to match ""square brackets ``[]``"", with the exception of one file.

In the data subsetting tutorial guide (`doc/source/getting_started/intro_tutorials/03_subset_data.rst`),  square brackets are specified towards the beginning of the guide, and ""selection brackets"" was used elsewhere, often to specify outer vs. inner square brackets (i.e. `df[['ColA', 'ColB']]`)","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57236/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57236/timeline,,
3,https://api.github.com/repos/pandas-dev/pandas/issues/57235,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57235/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57235/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57235/events,https://github.com/pandas-dev/pandas/pull/57235,2116717762,PR_kwDOAA0YD85l7VXe,57235,DOC: Updated docstring for set_option,"{'login': 'jrmylow', 'id': 33999325, 'node_id': 'MDQ6VXNlcjMzOTk5MzI1', 'avatar_url': 'https://avatars.githubusercontent.com/u/33999325?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jrmylow', 'html_url': 'https://github.com/jrmylow', 'followers_url': 'https://api.github.com/users/jrmylow/followers', 'following_url': 'https://api.github.com/users/jrmylow/following{/other_user}', 'gists_url': 'https://api.github.com/users/jrmylow/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jrmylow/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jrmylow/subscriptions', 'organizations_url': 'https://api.github.com/users/jrmylow/orgs', 'repos_url': 'https://api.github.com/users/jrmylow/repos', 'events_url': 'https://api.github.com/users/jrmylow/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jrmylow/received_events', 'type': 'User', 'site_admin': False}",[],open,False,,[],,2,2024-02-03T23:42:37Z,2024-02-03T23:49:11Z,,CONTRIBUTOR,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/57235', 'html_url': 'https://github.com/pandas-dev/pandas/pull/57235', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/57235.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/57235.patch', 'merged_at': None}","- [X] closes #57148
- [X] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [ ] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57235/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57235/timeline,,
4,https://api.github.com/repos/pandas-dev/pandas/issues/57233,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57233/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57233/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57233/events,https://github.com/pandas-dev/pandas/pull/57233,2116710632,PR_kwDOAA0YD85l7UKJ,57233,REGR: Fix to_numpy conversion for arrow ea with float dtype given,"{'login': 'phofl', 'id': 61934744, 'node_id': 'MDQ6VXNlcjYxOTM0NzQ0', 'avatar_url': 'https://avatars.githubusercontent.com/u/61934744?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/phofl', 'html_url': 'https://github.com/phofl', 'followers_url': 'https://api.github.com/users/phofl/followers', 'following_url': 'https://api.github.com/users/phofl/following{/other_user}', 'gists_url': 'https://api.github.com/users/phofl/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/phofl/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/phofl/subscriptions', 'organizations_url': 'https://api.github.com/users/phofl/orgs', 'repos_url': 'https://api.github.com/users/phofl/repos', 'events_url': 'https://api.github.com/users/phofl/events{/privacy}', 'received_events_url': 'https://api.github.com/users/phofl/received_events', 'type': 'User', 'site_admin': False}","[{'id': 3303158446, 'node_id': 'MDU6TGFiZWwzMzAzMTU4NDQ2', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Arrow', 'name': 'Arrow', 'color': 'f9d0c4', 'default': False, 'description': 'pyarrow functionality'}]",open,False,,[],"{'url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/116', 'html_url': 'https://github.com/pandas-dev/pandas/milestone/116', 'labels_url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/116/labels', 'id': 10403366, 'node_id': 'MI_kwDOAA0YD84Anr4m', 'number': 116, 'title': '2.2.1', 'description': 'on-merge: backport to 2.2.x', 'creator': {'login': 'lithomas1', 'id': 47963215, 'node_id': 'MDQ6VXNlcjQ3OTYzMjE1', 'avatar_url': 'https://avatars.githubusercontent.com/u/47963215?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/lithomas1', 'html_url': 'https://github.com/lithomas1', 'followers_url': 'https://api.github.com/users/lithomas1/followers', 'following_url': 'https://api.github.com/users/lithomas1/following{/other_user}', 'gists_url': 'https://api.github.com/users/lithomas1/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/lithomas1/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/lithomas1/subscriptions', 'organizations_url': 'https://api.github.com/users/lithomas1/orgs', 'repos_url': 'https://api.github.com/users/lithomas1/repos', 'events_url': 'https://api.github.com/users/lithomas1/events{/privacy}', 'received_events_url': 'https://api.github.com/users/lithomas1/received_events', 'type': 'User', 'site_admin': False}, 'open_issues': 41, 'closed_issues': 69, 'state': 'open', 'created_at': '2024-01-11T01:47:31Z', 'updated_at': '2024-02-04T03:08:15Z', 'due_on': None, 'closed_at': None}",0,2024-02-03T23:12:42Z,2024-02-04T00:07:55Z,,MEMBER,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/57233', 'html_url': 'https://github.com/pandas-dev/pandas/pull/57233', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/57233.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/57233.patch', 'merged_at': None}","- [ ] closes #xxxx (Replace xxxx with the GitHub issue number)
- [ ] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [ ] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
- [ ] Added [type annotations](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#type-hints) to new arguments/methods/functions.
- [ ] Added an entry in the latest `doc/source/whatsnew/vX.X.X.rst` file if fixing a bug or adding a new feature.

xref #57121","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57233/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57233/timeline,,
5,https://api.github.com/repos/pandas-dev/pandas/issues/57231,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57231/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57231/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57231/events,https://github.com/pandas-dev/pandas/pull/57231,2116701137,PR_kwDOAA0YD85l7Sdw,57231,DEPR: Remove Index type checking attributes,"{'login': 'mroeschke', 'id': 10647082, 'node_id': 'MDQ6VXNlcjEwNjQ3MDgy', 'avatar_url': 'https://avatars.githubusercontent.com/u/10647082?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/mroeschke', 'html_url': 'https://github.com/mroeschke', 'followers_url': 'https://api.github.com/users/mroeschke/followers', 'following_url': 'https://api.github.com/users/mroeschke/following{/other_user}', 'gists_url': 'https://api.github.com/users/mroeschke/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/mroeschke/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/mroeschke/subscriptions', 'organizations_url': 'https://api.github.com/users/mroeschke/orgs', 'repos_url': 'https://api.github.com/users/mroeschke/repos', 'events_url': 'https://api.github.com/users/mroeschke/events{/privacy}', 'received_events_url': 'https://api.github.com/users/mroeschke/received_events', 'type': 'User', 'site_admin': False}","[{'id': 1218227310, 'node_id': 'MDU6TGFiZWwxMjE4MjI3MzEw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Index', 'name': 'Index', 'color': 'e99695', 'default': False, 'description': 'Related to the Index class or subclasses'}]",open,False,,[],"{'url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/102', 'html_url': 'https://github.com/pandas-dev/pandas/milestone/102', 'labels_url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/102/labels', 'id': 9021906, 'node_id': 'MI_kwDOAA0YD84AianS', 'number': 102, 'title': '3.0', 'description': '', 'creator': {'login': 'jbrockmendel', 'id': 8078968, 'node_id': 'MDQ6VXNlcjgwNzg5Njg=', 'avatar_url': 'https://avatars.githubusercontent.com/u/8078968?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jbrockmendel', 'html_url': 'https://github.com/jbrockmendel', 'followers_url': 'https://api.github.com/users/jbrockmendel/followers', 'following_url': 'https://api.github.com/users/jbrockmendel/following{/other_user}', 'gists_url': 'https://api.github.com/users/jbrockmendel/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jbrockmendel/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jbrockmendel/subscriptions', 'organizations_url': 'https://api.github.com/users/jbrockmendel/orgs', 'repos_url': 'https://api.github.com/users/jbrockmendel/repos', 'events_url': 'https://api.github.com/users/jbrockmendel/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jbrockmendel/received_events', 'type': 'User', 'site_admin': False}, 'open_issues': 45, 'closed_issues': 150, 'state': 'open', 'created_at': '2023-02-08T18:16:49Z', 'updated_at': '2024-02-04T03:07:01Z', 'due_on': '2024-04-01T07:00:00Z', 'closed_at': None}",0,2024-02-03T22:35:19Z,2024-02-04T02:42:18Z,,MEMBER,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/57231', 'html_url': 'https://github.com/pandas-dev/pandas/pull/57231', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/57231.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/57231.patch', 'merged_at': None}","- [ ] closes #xxxx (Replace xxxx with the GitHub issue number)
- [ ] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [ ] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
- [ ] Added [type annotations](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#type-hints) to new arguments/methods/functions.
- [ ] Added an entry in the latest `doc/source/whatsnew/vX.X.X.rst` file if fixing a bug or adding a new feature.
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57231/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57231/timeline,,
6,https://api.github.com/repos/pandas-dev/pandas/issues/57226,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57226/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57226/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57226/events,https://github.com/pandas-dev/pandas/pull/57226,2116622677,PR_kwDOAA0YD85l7DRf,57226,WEB: Using Bootstrap icon instead of font awesome icons,"{'login': 'koushik-rout-samsung', 'id': 146946876, 'node_id': 'U_kgDOCMI7PA', 'avatar_url': 'https://avatars.githubusercontent.com/u/146946876?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/koushik-rout-samsung', 'html_url': 'https://github.com/koushik-rout-samsung', 'followers_url': 'https://api.github.com/users/koushik-rout-samsung/followers', 'following_url': 'https://api.github.com/users/koushik-rout-samsung/following{/other_user}', 'gists_url': 'https://api.github.com/users/koushik-rout-samsung/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/koushik-rout-samsung/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/koushik-rout-samsung/subscriptions', 'organizations_url': 'https://api.github.com/users/koushik-rout-samsung/orgs', 'repos_url': 'https://api.github.com/users/koushik-rout-samsung/repos', 'events_url': 'https://api.github.com/users/koushik-rout-samsung/events{/privacy}', 'received_events_url': 'https://api.github.com/users/koushik-rout-samsung/received_events', 'type': 'User', 'site_admin': False}","[{'id': 1508144531, 'node_id': 'MDU6TGFiZWwxNTA4MTQ0NTMx', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Web', 'name': 'Web', 'color': '23ef97', 'default': False, 'description': 'pandas website'}]",open,False,,[],,2,2024-02-03T18:11:13Z,2024-02-03T21:53:01Z,,NONE,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/57226', 'html_url': 'https://github.com/pandas-dev/pandas/pull/57226', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/57226.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/57226.patch', 'merged_at': None}","Closes https://github.com/pandas-dev/pandas/issues/57165
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57226/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57226/timeline,,
7,https://api.github.com/repos/pandas-dev/pandas/issues/57223,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57223/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57223/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57223/events,https://github.com/pandas-dev/pandas/pull/57223,2116463548,PR_kwDOAA0YD85l6iHK,57223,DOC: Replace pandas logo with a conditional image for light and dark â€¦,"{'login': 'LakshmanKishore', 'id': 61258323, 'node_id': 'MDQ6VXNlcjYxMjU4MzIz', 'avatar_url': 'https://avatars.githubusercontent.com/u/61258323?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/LakshmanKishore', 'html_url': 'https://github.com/LakshmanKishore', 'followers_url': 'https://api.github.com/users/LakshmanKishore/followers', 'following_url': 'https://api.github.com/users/LakshmanKishore/following{/other_user}', 'gists_url': 'https://api.github.com/users/LakshmanKishore/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/LakshmanKishore/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/LakshmanKishore/subscriptions', 'organizations_url': 'https://api.github.com/users/LakshmanKishore/orgs', 'repos_url': 'https://api.github.com/users/LakshmanKishore/repos', 'events_url': 'https://api.github.com/users/LakshmanKishore/events{/privacy}', 'received_events_url': 'https://api.github.com/users/LakshmanKishore/received_events', 'type': 'User', 'site_admin': False}",[],open,False,,[],,0,2024-02-03T12:29:31Z,2024-02-03T12:29:31Z,,NONE,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/57223', 'html_url': 'https://github.com/pandas-dev/pandas/pull/57223', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/57223.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/57223.patch', 'merged_at': None}","...themes

Replaced the static pandas logo with a `picture` tag that displays a different logo based on the color scheme. In light mode, the original logo is shown, while in dark mode, a white version of the logo is displayed for better visibility.

In GitHub Dark Theme
![image](https://github.com/pandas-dev/pandas/assets/61258323/a820a065-29d9-489a-b6f8-1e9d68bb5e57)

In GitHub Light Theme
![image](https://github.com/pandas-dev/pandas/assets/61258323/66ff39ee-8f6f-4271-9cf6-16d7ba229717)
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57223/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57223/timeline,,
8,https://api.github.com/repos/pandas-dev/pandas/issues/57222,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57222/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57222/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57222/events,https://github.com/pandas-dev/pandas/pull/57222,2116253943,PR_kwDOAA0YD85l502b,57222,"ENH: Add all warnings check to the assert_produces_warnings, and separate messages for each warning.","{'login': 'Jorewin', 'id': 56088851, 'node_id': 'MDQ6VXNlcjU2MDg4ODUx', 'avatar_url': 'https://avatars.githubusercontent.com/u/56088851?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/Jorewin', 'html_url': 'https://github.com/Jorewin', 'followers_url': 'https://api.github.com/users/Jorewin/followers', 'following_url': 'https://api.github.com/users/Jorewin/following{/other_user}', 'gists_url': 'https://api.github.com/users/Jorewin/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/Jorewin/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/Jorewin/subscriptions', 'organizations_url': 'https://api.github.com/users/Jorewin/orgs', 'repos_url': 'https://api.github.com/users/Jorewin/repos', 'events_url': 'https://api.github.com/users/Jorewin/events{/privacy}', 'received_events_url': 'https://api.github.com/users/Jorewin/received_events', 'type': 'User', 'site_admin': False}",[],open,False,,[],,0,2024-02-03T05:30:15Z,2024-02-03T20:23:50Z,,NONE,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/57222', 'html_url': 'https://github.com/pandas-dev/pandas/pull/57222', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/57222.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/57222.patch', 'merged_at': None}","The function in question gets used in multiple places, that's why I felt it would be safer to preserve current behavior and API, and add an additional, optional parameter, which alters the behavior, enabling checking if all passed warning types get detected.

- [x] closes #56555 (Replace xxxx with the GitHub issue number)
- [x] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [x] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
- [x] Added [type annotations](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#type-hints) to new arguments/methods/functions.
- [x] Added an entry in the latest `doc/source/whatsnew/vX.X.X.rst` file if fixing a bug or adding a new feature.
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57222/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57222/timeline,,
9,https://api.github.com/repos/pandas-dev/pandas/issues/57216,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57216/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57216/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57216/events,https://github.com/pandas-dev/pandas/issues/57216,2115839284,I_kwDOAA0YD85-HSU0,57216,"ENH: In sort methods, accept sequence or dict as key","{'login': 'gsehrlich', 'id': 11000354, 'node_id': 'MDQ6VXNlcjExMDAwMzU0', 'avatar_url': 'https://avatars.githubusercontent.com/u/11000354?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/gsehrlich', 'html_url': 'https://github.com/gsehrlich', 'followers_url': 'https://api.github.com/users/gsehrlich/followers', 'following_url': 'https://api.github.com/users/gsehrlich/following{/other_user}', 'gists_url': 'https://api.github.com/users/gsehrlich/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/gsehrlich/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/gsehrlich/subscriptions', 'organizations_url': 'https://api.github.com/users/gsehrlich/orgs', 'repos_url': 'https://api.github.com/users/gsehrlich/repos', 'events_url': 'https://api.github.com/users/gsehrlich/events{/privacy}', 'received_events_url': 'https://api.github.com/users/gsehrlich/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76812, 'node_id': 'MDU6TGFiZWw3NjgxMg==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Enhancement', 'name': 'Enhancement', 'color': '4E9A06', 'default': False, 'description': None}, {'id': 1218227310, 'node_id': 'MDU6TGFiZWwxMjE4MjI3MzEw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Index', 'name': 'Index', 'color': 'e99695', 'default': False, 'description': 'Related to the Index class or subclasses'}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}, {'id': 6323552771, 'node_id': 'LA_kwDOAA0YD88AAAABeOnCAw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Sorting', 'name': 'Sorting', 'color': 'f9d0c4', 'default': False, 'description': 'e.g. sort_index, sort_values'}]",open,False,,[],,1,2024-02-02T21:37:00Z,2024-02-02T23:09:51Z,,NONE,,,,"### Feature Type

- [X] Adding new functionality to pandas

- [ ] Changing existing functionality in pandas

- [ ] Removing existing functionality in pandas


### Problem Description

Pretty much every time I use the `key` kwarg of a pandas sort method, I use it to tell pandas the desired order of the unique values. For example:
```python
import pandas as pd

my_index = pd.Index(['one', 'two', 'three', 'three', 'two', 'one', 'three'])
my_index.sort_values(
    key=lambda idx: (idx
        .to_series()
        .rename(index={'one': 1, 'two': 2, 'three': 3})
        .index
    )
)
```
This is all a bit redundant, and I suspect it's a common use case.

Relatedly, sometimes I want to use a different key function for different columns/levels. In order to do that, I actually need to call the sort method multiple times.

### Feature Description

Accept sequences like `['one', 'two', 'three']` specifying the ascending order of the values.

EDIT: Example equivalent to the `sort_values` call above:

```python
my_index.sort_values(key=['one', 'two', 'three'])
```

Also accept dictionaries like `{'col_1': ['one', 'two', 'three'], 'col_3': my_sort_fn}` to sort different columns or levels with different keys in any format.

### Alternative Solutions

Make sure all data that I want to lexsort is always an ordered Categorical.

### Additional Context

_No response_","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57216/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57216/timeline,,
10,https://api.github.com/repos/pandas-dev/pandas/issues/57215,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57215/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57215/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57215/events,https://github.com/pandas-dev/pandas/issues/57215,2115764905,I_kwDOAA0YD85-HAKp,57215,BUG: Error when trying to use `pd.date_range`,"{'login': 'khider', 'id': 11758571, 'node_id': 'MDQ6VXNlcjExNzU4NTcx', 'avatar_url': 'https://avatars.githubusercontent.com/u/11758571?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/khider', 'html_url': 'https://github.com/khider', 'followers_url': 'https://api.github.com/users/khider/followers', 'following_url': 'https://api.github.com/users/khider/following{/other_user}', 'gists_url': 'https://api.github.com/users/khider/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/khider/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/khider/subscriptions', 'organizations_url': 'https://api.github.com/users/khider/orgs', 'repos_url': 'https://api.github.com/users/khider/repos', 'events_url': 'https://api.github.com/users/khider/events{/privacy}', 'received_events_url': 'https://api.github.com/users/khider/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,0,2024-02-02T20:39:36Z,2024-02-02T20:39:36Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [X] I have confirmed this bug exists on the [main branch](https://pandas.pydata.org/docs/dev/getting_started/install.html#installing-the-development-version-of-pandas) of pandas.


### Reproducible Example

```python
import pandas as pd
import numpy as np

pd.date_range(start = np.datetime64('500000000-01-01', 's'), end = np.datetime64('1500000000-01-01', 's'), freq='1000000000YS-JAN', unit='s')
```


### Issue Description

Error:
 raise ValueError(f""Offset {offset} did not increment date"")

ValueError: Offset <YearBegin: month=1> did not increment date



### Expected Behavior

Create my date range

### Installed Versions

INSTALLED VERSIONS
------------------
commit                : fd3f57170aa1af588ba877e8e28c158a20a4886d
python                : 3.11.7.final.0
python-bits           : 64
OS                    : Darwin
OS-release            : 23.1.0
Version               : Darwin Kernel Version 23.1.0: Mon Oct  9 21:32:11 PDT 2023; root:xnu-10002.41.9~7/RELEASE_ARM64_T6030
machine               : arm64
processor             : arm
byteorder             : little
LC_ALL                : en_US.UTF-8
LANG                  : en_US.UTF-8
LOCALE                : en_US.UTF-8

pandas                : 2.2.0
numpy                 : 1.26.3
pytz                  : 2023.3.post1
dateutil              : 2.8.2
setuptools            : 68.2.2
pip                   : 23.3.1
Cython                : None
pytest                : 8.0.0
hypothesis            : None
sphinx                : 5.0.2
blosc                 : None
feather               : None
xlsxwriter            : None
lxml.etree            : None
html5lib              : None
pymysql               : None
psycopg2              : None
jinja2                : 3.1.2
IPython               : 8.20.0
pandas_datareader     : None
adbc-driver-postgresql: None
adbc-driver-sqlite    : None
bs4                   : 4.12.2
bottleneck            : None
dataframe-api-compat  : None
fastparquet           : None
fsspec                : None
gcsfs                 : None
matplotlib            : 3.8.2
numba                 : 0.58.1
numexpr               : None
odfpy                 : None
openpyxl              : None
pandas_gbq            : None
pyarrow               : 15.0.0
pyreadstat            : None
python-calamine       : None
pyxlsb                : None
s3fs                  : None
scipy                 : 1.12.0
sqlalchemy            : None
tables                : None
tabulate              : 0.9.0
xarray                : None
xlrd                  : 2.0.1
zstandard             : None
tzdata                : 2023.4
qtpy                  : 2.4.1
pyqt5                 : None
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57215/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57215/timeline,,
11,https://api.github.com/repos/pandas-dev/pandas/issues/57214,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57214/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57214/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57214/events,https://github.com/pandas-dev/pandas/issues/57214,2115685556,I_kwDOAA0YD85-Gsy0,57214,ENH: pd.Series.str.isempty() to check for empty strings,"{'login': 'michaelquinn32', 'id': 3473921, 'node_id': 'MDQ6VXNlcjM0NzM5MjE=', 'avatar_url': 'https://avatars.githubusercontent.com/u/3473921?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/michaelquinn32', 'html_url': 'https://github.com/michaelquinn32', 'followers_url': 'https://api.github.com/users/michaelquinn32/followers', 'following_url': 'https://api.github.com/users/michaelquinn32/following{/other_user}', 'gists_url': 'https://api.github.com/users/michaelquinn32/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/michaelquinn32/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/michaelquinn32/subscriptions', 'organizations_url': 'https://api.github.com/users/michaelquinn32/orgs', 'repos_url': 'https://api.github.com/users/michaelquinn32/repos', 'events_url': 'https://api.github.com/users/michaelquinn32/events{/privacy}', 'received_events_url': 'https://api.github.com/users/michaelquinn32/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76812, 'node_id': 'MDU6TGFiZWw3NjgxMg==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Enhancement', 'name': 'Enhancement', 'color': '4E9A06', 'default': False, 'description': None}, {'id': 57522093, 'node_id': 'MDU6TGFiZWw1NzUyMjA5Mw==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Strings', 'name': 'Strings', 'color': '5319e7', 'default': False, 'description': 'String extension data type and string data'}, {'id': 2365504893, 'node_id': 'MDU6TGFiZWwyMzY1NTA0ODkz', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Closing%20Candidate', 'name': 'Closing Candidate', 'color': 'be21f2', 'default': False, 'description': 'May be closeable, needs more eyeballs'}]",open,False,,[],,1,2024-02-02T20:03:53Z,2024-02-03T11:43:16Z,,NONE,,,,"### Feature Type

- [X] Adding new functionality to pandas

- [ ] Changing existing functionality in pandas

- [ ] Removing existing functionality in pandas


### Problem Description

The current pattern for empty strings is to do an equals comparion

```python
strings = pd.Series(['a', '', 'b'])
strings == ''
```

There are often recommendations to check truthiness of strings with implicit boolean values, e.g.
https://pylint.readthedocs.io/en/latest/user_guide/messages/convention/use-implicit-booleaness-not-comparison.html

This method would be similar to other string checking patterns, like `pd.Series.str.isspace()`. While this does deviate from the existing str api that the methods seek to follow, the approach from the str api to checking strings fails because pd.Series objects don't have an implicit truth value.

This would also make more fluid to combine operations:

```python
strings.mask(strings.str.isempty() | strings.str.isspace(), 'empty')
```

### Feature Description

In [pandas/core/strings/object_array.py](https://github.com/pandas-dev/pandas/blob/4f0870efecff989c211dd8cfe975ef2127cc86b8/pandas/core/strings/object_array.py#L4)

```python
def _str_isempty(self):
        return self._str_map(lambda s: s == '', dtype=""bool"")
```

### Alternative Solutions

N/A

### Additional Context

_No response_","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57214/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57214/timeline,,
12,https://api.github.com/repos/pandas-dev/pandas/issues/57213,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57213/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57213/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57213/events,https://github.com/pandas-dev/pandas/issues/57213,2115536364,I_kwDOAA0YD85-GIXs,57213,BUG: to_numeric loses precision when converting decimal type to integer,"{'login': 'sfc-gh-aalam', 'id': 107440467, 'node_id': 'U_kgDOBmdpUw', 'avatar_url': 'https://avatars.githubusercontent.com/u/107440467?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/sfc-gh-aalam', 'html_url': 'https://github.com/sfc-gh-aalam', 'followers_url': 'https://api.github.com/users/sfc-gh-aalam/followers', 'following_url': 'https://api.github.com/users/sfc-gh-aalam/following{/other_user}', 'gists_url': 'https://api.github.com/users/sfc-gh-aalam/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/sfc-gh-aalam/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/sfc-gh-aalam/subscriptions', 'organizations_url': 'https://api.github.com/users/sfc-gh-aalam/orgs', 'repos_url': 'https://api.github.com/users/sfc-gh-aalam/repos', 'events_url': 'https://api.github.com/users/sfc-gh-aalam/events{/privacy}', 'received_events_url': 'https://api.github.com/users/sfc-gh-aalam/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 31404521, 'node_id': 'MDU6TGFiZWwzMTQwNDUyMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Dtype%20Conversions', 'name': 'Dtype Conversions', 'color': 'e102d8', 'default': False, 'description': 'Unexpected or buggy dtype conversions'}]",open,False,,[],,1,2024-02-02T18:34:30Z,2024-02-03T11:49:37Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [ ] I have confirmed this bug exists on the [main branch](https://pandas.pydata.org/docs/dev/getting_started/install.html#installing-the-development-version-of-pandas) of pandas.


### Reproducible Example

```python
from decimal import *
import pandas as pd

df = pd.DataFrame({'column1': [Decimal('1'*19)]})
print(pd.to_numeric(df['column1'], downcast='integer'))
print(df['column1'].astype('int64'))

""""""
0    1111111111111111168
Name: column1, dtype: int64
0    1111111111111111111
Name: column1, dtype: int64
""""""
```


### Issue Description

When converting data from decimal type to integer using `to_numeric`, we see loss of precision where as doing the same conversion using `astype('int64')` works as expected without any precision loss.

### Expected Behavior

Perform the conversion without a precision loss

### Installed Versions

<details>

INSTALLED VERSIONS
------------------
commit                : fd3f57170aa1af588ba877e8e28c158a20a4886d
python                : 3.9.16.final.0
python-bits           : 64
OS                    : Darwin
OS-release            : 23.2.0
Version               : Darwin Kernel Version 23.2.0: Wed Nov 15 21:53:18 PST 2023; root:xnu-10002.61.3~2/RELEASE_ARM64_T6000
machine               : arm64
processor             : arm
byteorder             : little
LC_ALL                : None
LANG                  : en_US.UTF-8
LOCALE                : en_US.UTF-8

pandas                : 2.2.0
numpy                 : 1.24.2
pytz                  : 2022.7.1
dateutil              : 2.8.2
setuptools            : 65.6.3
pip                   : 23.0.1
Cython                : 0.29.34
pytest                : None
hypothesis            : None
sphinx                : 5.0.2
blosc                 : None
feather               : None
xlsxwriter            : None
lxml.etree            : None
html5lib              : None
pymysql               : None
psycopg2              : None
jinja2                : 3.1.2
IPython               : None
pandas_datareader     : None
adbc-driver-postgresql: None
adbc-driver-sqlite    : None
bs4                   : None
bottleneck            : None
dataframe-api-compat  : None
fastparquet           : None
fsspec                : None
gcsfs                 : None
matplotlib            : 3.8.2
numba                 : None
numexpr               : None
odfpy                 : None
openpyxl              : None
pandas_gbq            : None
pyarrow               : 10.0.1
pyreadstat            : None
python-calamine       : None
pyxlsb                : None
s3fs                  : None
scipy                 : 1.11.2
sqlalchemy            : None
tables                : None
tabulate              : None
xarray                : None
xlrd                  : None
zstandard             : None
tzdata                : 2023.4
qtpy                  : None
pyqt5                 : None
</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57213/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57213/timeline,,
13,https://api.github.com/repos/pandas-dev/pandas/issues/57212,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57212/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57212/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57212/events,https://github.com/pandas-dev/pandas/pull/57212,2114982768,PR_kwDOAA0YD85l1aX0,57212,BUG: ensure_string_array might modify read-only array inplace,"{'login': 'phofl', 'id': 61934744, 'node_id': 'MDQ6VXNlcjYxOTM0NzQ0', 'avatar_url': 'https://avatars.githubusercontent.com/u/61934744?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/phofl', 'html_url': 'https://github.com/phofl', 'followers_url': 'https://api.github.com/users/phofl/followers', 'following_url': 'https://api.github.com/users/phofl/following{/other_user}', 'gists_url': 'https://api.github.com/users/phofl/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/phofl/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/phofl/subscriptions', 'organizations_url': 'https://api.github.com/users/phofl/orgs', 'repos_url': 'https://api.github.com/users/phofl/repos', 'events_url': 'https://api.github.com/users/phofl/events{/privacy}', 'received_events_url': 'https://api.github.com/users/phofl/received_events', 'type': 'User', 'site_admin': False}",[],open,False,,[],,0,2024-02-02T13:51:24Z,2024-02-03T23:02:08Z,,MEMBER,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/57212', 'html_url': 'https://github.com/pandas-dev/pandas/pull/57212', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/57212.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/57212.patch', 'merged_at': None}","We ran into this in Dask, it's quite the edge case...","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57212/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57212/timeline,,
14,https://api.github.com/repos/pandas-dev/pandas/issues/57205,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57205/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57205/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57205/events,https://github.com/pandas-dev/pandas/pull/57205,2113909202,PR_kwDOAA0YD85lxtUd,57205,"PERF: Avoid Series constructor in DataFrame(dict(...), columns=)","{'login': 'mroeschke', 'id': 10647082, 'node_id': 'MDQ6VXNlcjEwNjQ3MDgy', 'avatar_url': 'https://avatars.githubusercontent.com/u/10647082?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/mroeschke', 'html_url': 'https://github.com/mroeschke', 'followers_url': 'https://api.github.com/users/mroeschke/followers', 'following_url': 'https://api.github.com/users/mroeschke/following{/other_user}', 'gists_url': 'https://api.github.com/users/mroeschke/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/mroeschke/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/mroeschke/subscriptions', 'organizations_url': 'https://api.github.com/users/mroeschke/orgs', 'repos_url': 'https://api.github.com/users/mroeschke/repos', 'events_url': 'https://api.github.com/users/mroeschke/events{/privacy}', 'received_events_url': 'https://api.github.com/users/mroeschke/received_events', 'type': 'User', 'site_admin': False}","[{'id': 8935311, 'node_id': 'MDU6TGFiZWw4OTM1MzEx', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Performance', 'name': 'Performance', 'color': 'a10c02', 'default': False, 'description': 'Memory or execution speed performance'}, {'id': 1049312478, 'node_id': 'MDU6TGFiZWwxMDQ5MzEyNDc4', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/DataFrame', 'name': 'DataFrame', 'color': '370f77', 'default': False, 'description': 'DataFrame data structure'}]",open,False,,[],"{'url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/102', 'html_url': 'https://github.com/pandas-dev/pandas/milestone/102', 'labels_url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/102/labels', 'id': 9021906, 'node_id': 'MI_kwDOAA0YD84AianS', 'number': 102, 'title': '3.0', 'description': '', 'creator': {'login': 'jbrockmendel', 'id': 8078968, 'node_id': 'MDQ6VXNlcjgwNzg5Njg=', 'avatar_url': 'https://avatars.githubusercontent.com/u/8078968?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/jbrockmendel', 'html_url': 'https://github.com/jbrockmendel', 'followers_url': 'https://api.github.com/users/jbrockmendel/followers', 'following_url': 'https://api.github.com/users/jbrockmendel/following{/other_user}', 'gists_url': 'https://api.github.com/users/jbrockmendel/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/jbrockmendel/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/jbrockmendel/subscriptions', 'organizations_url': 'https://api.github.com/users/jbrockmendel/orgs', 'repos_url': 'https://api.github.com/users/jbrockmendel/repos', 'events_url': 'https://api.github.com/users/jbrockmendel/events{/privacy}', 'received_events_url': 'https://api.github.com/users/jbrockmendel/received_events', 'type': 'User', 'site_admin': False}, 'open_issues': 45, 'closed_issues': 150, 'state': 'open', 'created_at': '2023-02-08T18:16:49Z', 'updated_at': '2024-02-04T03:07:01Z', 'due_on': '2024-04-01T07:00:00Z', 'closed_at': None}",0,2024-02-02T02:36:52Z,2024-02-02T21:50:44Z,,MEMBER,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/57205', 'html_url': 'https://github.com/pandas-dev/pandas/pull/57205', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/57205.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/57205.patch', 'merged_at': None}","- [ ] closes #24368 (Replace xxxx with the GitHub issue number)
- [ ] closed #25887
- [ ] Added an entry in the latest `doc/source/whatsnew/vX.X.X.rst` file if fixing a bug or adding a new feature.


```python
import pandas as pd, numpy as np
a = pd.Series(np.array([1, 2, 3]))
columns = range(10_000)
data = {i: a for i in columns}
%timeit pd.DataFrame(data, columns=columns)

51.3 ms Â± 96 Âµs per loop (mean Â± std. dev. of 7 runs, 10 loops each) # PR
102 ms Â± 1.8 ms per loop (mean Â± std. dev. of 7 runs, 10 loops each) # main
```

```python
In [1]: import pandas as pd

In [2]: %timeit pd.DataFrame([], columns=['a'])
37.3 Âµs Â± 231 ns per loop (mean Â± std. dev. of 7 runs, 10,000 loops each)  # PR
183 Âµs Â± 584 ns per loop (mean Â± std. dev. of 7 runs, 10,000 loops each)  # main
```","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57205/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57205/timeline,,
15,https://api.github.com/repos/pandas-dev/pandas/issues/57204,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57204/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57204/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57204/events,https://github.com/pandas-dev/pandas/pull/57204,2113870822,PR_kwDOAA0YD85lxlJ9,57204,PDEP-14: Publish translations of pandas.pydata.org,"{'login': 'steppi', 'id': 1953382, 'node_id': 'MDQ6VXNlcjE5NTMzODI=', 'avatar_url': 'https://avatars.githubusercontent.com/u/1953382?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/steppi', 'html_url': 'https://github.com/steppi', 'followers_url': 'https://api.github.com/users/steppi/followers', 'following_url': 'https://api.github.com/users/steppi/following{/other_user}', 'gists_url': 'https://api.github.com/users/steppi/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/steppi/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/steppi/subscriptions', 'organizations_url': 'https://api.github.com/users/steppi/orgs', 'repos_url': 'https://api.github.com/users/steppi/repos', 'events_url': 'https://api.github.com/users/steppi/events{/privacy}', 'received_events_url': 'https://api.github.com/users/steppi/received_events', 'type': 'User', 'site_admin': False}","[{'id': 4253279386, 'node_id': 'LA_kwDOAA0YD879g-Sa', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/PDEP', 'name': 'PDEP', 'color': '4B02F8', 'default': False, 'description': 'pandas enhancement proposal'}]",open,False,,[],,12,2024-02-02T01:53:51Z,2024-02-03T18:53:42Z,,NONE,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/57204', 'html_url': 'https://github.com/pandas-dev/pandas/pull/57204', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/57204.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/57204.patch', 'merged_at': None}","Following up on the discussion in #56301, this PR adds a first draft for a PDEP proposing creation and publication of translations of the core website content.

To summarize, the [Scientific Python community and communications infrastructure grant](https://scientific-python.org/doc/scientific-python-community-and-communications-infrastructure-2022.pdf) is supporting work to facilitate official translation of content from the websites of [Scientific Python core projects](https://scientific-python.org/specs/core-projects/) and publication of these translations. This PDEP proposes that Pandas participates in these efforts. The hope is that the bulk of the work would be taken on by myself and/or a colleague at Quansight, and the work required by Pandas maintainers would be minimal.

There's more information in the PDEP below. Thank you. Looking forward to hearing your feedback.","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57204/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57204/timeline,,
16,https://api.github.com/repos/pandas-dev/pandas/issues/57197,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57197/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57197/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57197/events,https://github.com/pandas-dev/pandas/issues/57197,2113253877,I_kwDOAA0YD8599bH1,57197,BUG: ValueError: Invalid frequency: ME,"{'login': 'celestinoxp', 'id': 41735311, 'node_id': 'MDQ6VXNlcjQxNzM1MzEx', 'avatar_url': 'https://avatars.githubusercontent.com/u/41735311?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/celestinoxp', 'html_url': 'https://github.com/celestinoxp', 'followers_url': 'https://api.github.com/users/celestinoxp/followers', 'following_url': 'https://api.github.com/users/celestinoxp/following{/other_user}', 'gists_url': 'https://api.github.com/users/celestinoxp/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/celestinoxp/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/celestinoxp/subscriptions', 'organizations_url': 'https://api.github.com/users/celestinoxp/orgs', 'repos_url': 'https://api.github.com/users/celestinoxp/repos', 'events_url': 'https://api.github.com/users/celestinoxp/events{/privacy}', 'received_events_url': 'https://api.github.com/users/celestinoxp/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 307649777, 'node_id': 'MDU6TGFiZWwzMDc2NDk3Nzc=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Info', 'name': 'Needs Info', 'color': '207de5', 'default': False, 'description': 'Clarification about behavior needed to assess issue'}]",open,False,,[],,1,2024-02-01T19:02:39Z,2024-02-03T12:01:48Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [ ] I have confirmed this bug exists on the [main branch](https://pandas.pydata.org/docs/dev/getting_started/install.html#installing-the-development-version-of-pandas) of pandas.


### Reproducible Example

```python
.
```


### Issue Description

I'm testing a pull-request on pycaret https://github.com/pycaret/pycaret/pull/3857 to support new scikit-learn 1.4, and new pandas 2.2.0 also.

I fixed/removed deprecated ALIAS of time frequencies, as you can see here: https://github.com/pycaret/pycaret/pull/3857/commits/039f159ab25f22f68d3f0d6820a94c40e3f4173f

However as i can see in pandas doccumentation of pandas 2.2 https://pandas.pydata.org/docs/whatsnew/v2.2.0.html#deprecate-aliases-m-q-y-etc-in-favour-of-me-qe-ye-etc-for-offsets, the alias M is changed to ME, but something is wrong because i receive an error because ME is in use... i give you an picture of my vscode:

![image](https://github.com/pandas-dev/pandas/assets/41735311/d98c5934-ad46-48c8-837f-4245b1b5f5e3)

As you can see, have an error ValueError: Invalid frequency: ME, failed to parse with error message: ValueError(""for Period, please use 'M' instead of 'ME'"")

but i have pandas 2.2 as you can see (i used terminal to show pandas version)

### Expected Behavior

No errors

### Installed Versions

<details>

INSTALLED VERSIONS
------------------
commit                : f538741432edf55c6b9fb5d0d496d2dd1d7c2457
python                : 3.10.13.final.0
python-bits           : 64
OS                    : Windows
OS-release            : 10
Version               : 10.0.22631
machine               : AMD64
processor             : AMD64 Family 23 Model 96 Stepping 1, AuthenticAMD
byteorder             : little
LC_ALL                : None
LANG                  : pt_BR.UTF-8
LOCALE                : Portuguese_Portugal.1252

pandas                : 2.2.0
numpy                 : 1.26.3
pytz                  : 2022.7.1
dateutil              : 2.8.2
setuptools            : 69.0.3
pip                   : 23.3.2
Cython                : 0.29.36
pytest                : 7.4.3
hypothesis            : None
sphinx                : None
blosc                 : None
feather               : None
xlsxwriter            : None
lxml.etree            : 4.9.3
html5lib              : None
pymysql               : None
psycopg2              : None
jinja2                : 3.1.3
IPython               : 8.20.0
pandas_datareader     : None
adbc-driver-postgresql: None
adbc-driver-sqlite    : None
bs4                   : 4.12.2
bottleneck            : None
dataframe-api-compat  : None
fastparquet           : None
fsspec                : 2023.10.0
gcsfs                 : None
matplotlib            : 3.8.2
numba                 : 0.58.1
numexpr               : None
odfpy                 : None
openpyxl              : None
pandas_gbq            : None
pyarrow               : None
pyreadstat            : None
python-calamine       : None
pyxlsb                : None
s3fs                  : None
scipy                 : 1.11.4
sqlalchemy            : None
tables                : None
tabulate              : 0.9.0
xarray                : None
xlrd                  : None
zstandard             : None
tzdata                : 2023.3
qtpy                  : None
pyqt5                 : None

</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57197/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57197/timeline,,
17,https://api.github.com/repos/pandas-dev/pandas/issues/57196,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57196/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57196/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57196/events,https://github.com/pandas-dev/pandas/issues/57196,2112713037,I_kwDOAA0YD8597XFN,57196,BUG: Dataframe's `to_sql` method fails while trying to persist Dataframe to Postgtres in Version 2.2.0,"{'login': 'damianr13', 'id': 7912289, 'node_id': 'MDQ6VXNlcjc5MTIyODk=', 'avatar_url': 'https://avatars.githubusercontent.com/u/7912289?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/damianr13', 'html_url': 'https://github.com/damianr13', 'followers_url': 'https://api.github.com/users/damianr13/followers', 'following_url': 'https://api.github.com/users/damianr13/following{/other_user}', 'gists_url': 'https://api.github.com/users/damianr13/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/damianr13/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/damianr13/subscriptions', 'organizations_url': 'https://api.github.com/users/damianr13/orgs', 'repos_url': 'https://api.github.com/users/damianr13/repos', 'events_url': 'https://api.github.com/users/damianr13/events{/privacy}', 'received_events_url': 'https://api.github.com/users/damianr13/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,2,2024-02-01T14:50:31Z,2024-02-04T02:05:20Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [X] I have confirmed this bug exists on the [main branch](https://pandas.pydata.org/docs/dev/getting_started/install.html#installing-the-development-version-of-pandas) of pandas.


### Reproducible Example

```python
import pandas as pd
from sqlalchemy import create_engine

from .settings import get_settings  # pydantic way of reading the env variables

conn_string = get_settings().db_conn_string
df = pd.DataFrame(range(5), columns=[""id""])
db = create_engine(conn_string)
conn = db.connect()

nr_rows = df.to_sql(
    ""temp_pandas_test"", con=conn, if_exists=""replace"", index=False, chunksize=1000
)
```


### Issue Description

Exporting a pandas dataframe to Postgres doesn't work anymore in version 2.2.0. The code above works well with version 2.1.2, but in version 2.2.0 it fails with the following error: 

```
Traceback (most recent call last):
  File ""/Users/robert-andreidamian/Workspace/panprices/shelf_analytics_update_products/demo.py"", line 14, in <module>
    nr_rows = df.to_sql(
  File ""/Users/robert-andreidamian/.local/share/virtualenvs/shelf_analytics_update_products-BwnpeEoI/lib/python3.9/site-packages/pandas/util/_decorators.py"", line 333, in wrapper
    return func(*args, **kwargs)
  File ""/Users/robert-andreidamian/.local/share/virtualenvs/shelf_analytics_update_products-BwnpeEoI/lib/python3.9/site-packages/pandas/core/generic.py"", line 3059, in to_sql
    return sql.to_sql(
  File ""/Users/robert-andreidamian/.local/share/virtualenvs/shelf_analytics_update_products-BwnpeEoI/lib/python3.9/site-packages/pandas/io/sql.py"", line 858, in to_sql
    return pandas_sql.to_sql(
  File ""/Users/robert-andreidamian/.local/share/virtualenvs/shelf_analytics_update_products-BwnpeEoI/lib/python3.9/site-packages/pandas/io/sql.py"", line 2867, in to_sql
    table.create()
  File ""/Users/robert-andreidamian/.local/share/virtualenvs/shelf_analytics_update_products-BwnpeEoI/lib/python3.9/site-packages/pandas/io/sql.py"", line 1000, in create
    if self.exists():
  File ""/Users/robert-andreidamian/.local/share/virtualenvs/shelf_analytics_update_products-BwnpeEoI/lib/python3.9/site-packages/pandas/io/sql.py"", line 986, in exists
    return self.pd_sql.has_table(self.name, self.schema)
  File ""/Users/robert-andreidamian/.local/share/virtualenvs/shelf_analytics_update_products-BwnpeEoI/lib/python3.9/site-packages/pandas/io/sql.py"", line 2882, in has_table
    return len(self.execute(query, [name]).fetchall()) > 0
  File ""/Users/robert-andreidamian/.local/share/virtualenvs/shelf_analytics_update_products-BwnpeEoI/lib/python3.9/site-packages/pandas/io/sql.py"", line 2689, in execute
    cur = self.con.cursor()
AttributeError: 'Connection' object has no attribute 'cursor'
```

I noticed that [a new driver](https://pandas.pydata.org/docs/whatsnew/v2.2.0.html#adbc-driver-support-in-to-sql-and-read-sql) was added in Version 2.2.0, which might be related to my issue. 

### Expected Behavior

The code above should execute the same way it used to do with the previous version, and export the dataframe to a table in my Postgres Database. 

### Installed Versions

INSTALLED VERSIONS
------------------
commit                : c3014abb3bf2e15fa66d194ebd2867161527c497
python                : 3.9.13.final.0
python-bits           : 64
OS                    : Darwin
OS-release            : 23.1.0
Version               : Darwin Kernel Version 23.1.0: Mon Oct  9 21:32:52 PDT 2023; root:xnu-10002.41.9~7/RELEASE_ARM64_T8122
machine               : x86_64
processor             : i386
byteorder             : little
LC_ALL                : None
LANG                  : None
LOCALE                : en_GB.UTF-8
pandas                : 3.0.0.dev0+210.gc3014abb3b
numpy                 : 1.26.3
pytz                  : 2023.4
dateutil              : 2.8.2
setuptools            : 68.2.2
pip                   : 23.3.1
Cython                : None
pytest                : None
hypothesis            : None
sphinx                : None
blosc                 : None
feather               : None
xlsxwriter            : None
lxml.etree            : 5.1.0
html5lib              : None
pymysql               : None
psycopg2              : 2.9.9
jinja2                : 3.1.3
IPython               : None
pandas_datareader     : None
adbc-driver-postgresql: None
adbc-driver-sqlite    : None
bs4                   : None
bottleneck            : None
dataframe-api-compat  : None
fastparquet           : None
fsspec                : None
gcsfs                 : None
matplotlib            : None
numba                 : None
numexpr               : None
odfpy                 : None
openpyxl              : 3.1.2
pandas_gbq            : None
pyarrow               : None
pyreadstat            : None
python-calamine       : None
pyxlsb                : None
s3fs                  : None
scipy                 : None
sqlalchemy            : None
tables                : None
tabulate              : None
xarray                : None
xlrd                  : None
zstandard             : None
tzdata                : 2023.4
qtpy                  : None
pyqt5                 : None","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57196/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57196/timeline,,
18,https://api.github.com/repos/pandas-dev/pandas/issues/57193,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57193/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57193/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57193/events,https://github.com/pandas-dev/pandas/pull/57193,2112219935,PR_kwDOAA0YD85lr1qK,57193,BUG: fix bug in DataFrame.diff when dataframe has bool dtype and axis=1,"{'login': 'yuanx749', 'id': 47032563, 'node_id': 'MDQ6VXNlcjQ3MDMyNTYz', 'avatar_url': 'https://avatars.githubusercontent.com/u/47032563?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/yuanx749', 'html_url': 'https://github.com/yuanx749', 'followers_url': 'https://api.github.com/users/yuanx749/followers', 'following_url': 'https://api.github.com/users/yuanx749/following{/other_user}', 'gists_url': 'https://api.github.com/users/yuanx749/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/yuanx749/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/yuanx749/subscriptions', 'organizations_url': 'https://api.github.com/users/yuanx749/orgs', 'repos_url': 'https://api.github.com/users/yuanx749/repos', 'events_url': 'https://api.github.com/users/yuanx749/events{/privacy}', 'received_events_url': 'https://api.github.com/users/yuanx749/received_events', 'type': 'User', 'site_admin': False}",[],open,False,,[],,1,2024-02-01T11:04:52Z,2024-02-01T12:41:06Z,,CONTRIBUTOR,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/57193', 'html_url': 'https://github.com/pandas-dev/pandas/pull/57193', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/57193.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/57193.patch', 'merged_at': None}","supersede #53248

- [x] closes #52579 (Replace xxxx with the GitHub issue number)
- [x] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [x] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
- [ ] Added [type annotations](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#type-hints) to new arguments/methods/functions.
- [x] Added an entry in the latest `doc/source/whatsnew/vX.X.X.rst` file if fixing a bug or adding a new feature.
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57193/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57193/timeline,,
19,https://api.github.com/repos/pandas-dev/pandas/issues/57192,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57192/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57192/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57192/events,https://github.com/pandas-dev/pandas/issues/57192,2112052708,I_kwDOAA0YD859413k,57192,BUG: pandas 2.2.0 `DataFrame.groupby` regression when group labels of type `pd.Timestamp`,"{'login': 'maread99', 'id': 56914820, 'node_id': 'MDQ6VXNlcjU2OTE0ODIw', 'avatar_url': 'https://avatars.githubusercontent.com/u/56914820?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/maread99', 'html_url': 'https://github.com/maread99', 'followers_url': 'https://api.github.com/users/maread99/followers', 'following_url': 'https://api.github.com/users/maread99/following{/other_user}', 'gists_url': 'https://api.github.com/users/maread99/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/maread99/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/maread99/subscriptions', 'organizations_url': 'https://api.github.com/users/maread99/orgs', 'repos_url': 'https://api.github.com/users/maread99/repos', 'events_url': 'https://api.github.com/users/maread99/events{/privacy}', 'received_events_url': 'https://api.github.com/users/maread99/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 233160, 'node_id': 'MDU6TGFiZWwyMzMxNjA=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Groupby', 'name': 'Groupby', 'color': '729FCF', 'default': False, 'description': None}, {'id': 32815646, 'node_id': 'MDU6TGFiZWwzMjgxNTY0Ng==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Regression', 'name': 'Regression', 'color': 'e11d21', 'default': False, 'description': 'Functionality that used to work in a prior pandas version'}, {'id': 60458168, 'node_id': 'MDU6TGFiZWw2MDQ1ODE2OA==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Timezones', 'name': 'Timezones', 'color': '5319e7', 'default': False, 'description': 'Timezone data dtype'}]",open,False,,[],"{'url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/116', 'html_url': 'https://github.com/pandas-dev/pandas/milestone/116', 'labels_url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/116/labels', 'id': 10403366, 'node_id': 'MI_kwDOAA0YD84Anr4m', 'number': 116, 'title': '2.2.1', 'description': 'on-merge: backport to 2.2.x', 'creator': {'login': 'lithomas1', 'id': 47963215, 'node_id': 'MDQ6VXNlcjQ3OTYzMjE1', 'avatar_url': 'https://avatars.githubusercontent.com/u/47963215?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/lithomas1', 'html_url': 'https://github.com/lithomas1', 'followers_url': 'https://api.github.com/users/lithomas1/followers', 'following_url': 'https://api.github.com/users/lithomas1/following{/other_user}', 'gists_url': 'https://api.github.com/users/lithomas1/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/lithomas1/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/lithomas1/subscriptions', 'organizations_url': 'https://api.github.com/users/lithomas1/orgs', 'repos_url': 'https://api.github.com/users/lithomas1/repos', 'events_url': 'https://api.github.com/users/lithomas1/events{/privacy}', 'received_events_url': 'https://api.github.com/users/lithomas1/received_events', 'type': 'User', 'site_admin': False}, 'open_issues': 41, 'closed_issues': 69, 'state': 'open', 'created_at': '2024-01-11T01:47:31Z', 'updated_at': '2024-02-04T03:08:15Z', 'due_on': None, 'closed_at': None}",1,2024-02-01T09:52:11Z,2024-02-03T12:43:12Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [ ] I have confirmed this bug exists on the [main branch](https://pandas.pydata.org/docs/dev/getting_started/install.html#installing-the-development-version-of-pandas) of pandas.


### Reproducible Example

```python
import pandas as pd
assert pd.__version__ == ""2.2.0""

index = pd.date_range(""2024-02-01"", ""2024-02-03"", freq=""8h"", tz=""UTC"")

# index
# DatetimeIndex(['2024-02-01 00:00:00+00:00', '2024-02-01 08:00:00+00:00',
#                '2024-02-01 16:00:00+00:00', '2024-02-02 00:00:00+00:00',
#                '2024-02-02 08:00:00+00:00', '2024-02-02 16:00:00+00:00',
#                '2024-02-03 00:00:00+00:00'],
#               dtype='datetime64[ns, UTC]', freq='8h')

df = pd.DataFrame([1] * len(index), index)

def f(ts: pd.Timestamp) -> pd.Timestamp:
    """"""Group by date, i.e. as timezone naive timestamp.""""""
    return ts.normalize().tz_convert(None)

grouped = df.groupby(by=f)
keys = list(grouped.groups.keys())
print(keys)

# [Timestamp('2024-02-01 00:00:00+0000', tz='UTC'),
#  Timestamp('2024-02-02 00:00:00+0000', tz='UTC'),
#  Timestamp('2024-02-03 00:00:00+0000', tz='UTC')]
```


### Issue Description

Although the return from the 'by' function is timezone naive, the group labels are timezone aware (UTC).

(I've tried every combination of the `as_index` and `group_keys` options, always get the same group keys).

### Expected Behavior

Would have expected behaviour as pandas 2.1.4 and prior, i.e,. group keys as returned from the 'by' function...

```python
import pandas as pd
assert pd.__version__ == ""2.1.4""

index = pd.date_range(""2024-02-01"", ""2024-02-03"", freq=""8h"", tz=""UTC"")
df = pd.DataFrame([1] * len(index), index)

def f(ts: pd.Timestamp) -> pd.Timestamp:
    return ts.normalize().tz_convert(None)

grouped = df.groupby(by=f)
keys = list(grouped.groups.keys())
print(keys)
```
```
[Timestamp('2024-02-01 00:00:00'),
 Timestamp('2024-02-02 00:00:00'),
 Timestamp('2024-02-03 00:00:00')]
```

### Installed Versions

<details>

INSTALLED VERSIONS
------------------
commit                : f538741432edf55c6b9fb5d0d496d2dd1d7c2457
python                : 3.9.13.final.0
python-bits           : 64
OS                    : Windows
OS-release            : 10
Version               : 10.0.22631
machine               : AMD64
processor             : Intel64 Family 6 Model 141 Stepping 1, GenuineIntel
byteorder             : little
LC_ALL                : None
LANG                  : None
LOCALE                : English_United Kingdom.1252

pandas                : 2.2.0
numpy                 : 1.26.3
pytz                  : 2023.4
dateutil              : 2.8.2
setuptools            : 58.1.0
pip                   : 23.3.2
Cython                : None
pytest                : 8.0.0
hypothesis            : 6.97.3
sphinx                : None
blosc                 : None
feather               : None
xlsxwriter            : None
lxml.etree            : 4.9.4
html5lib              : None
pymysql               : None
psycopg2              : None
jinja2                : None
IPython               : 8.14.0
pandas_datareader     : None
adbc-driver-postgresql: None
adbc-driver-sqlite    : None
bs4                   : 4.12.3
bottleneck            : None
dataframe-api-compat  : None
fastparquet           : None
fsspec                : None
gcsfs                 : None
matplotlib            : None
numba                 : None
numexpr               : 2.9.0
odfpy                 : None
openpyxl              : None
pandas_gbq            : None
pyarrow               : 15.0.0
pyreadstat            : None
python-calamine       : None
pyxlsb                : None
s3fs                  : None
scipy                 : None
sqlalchemy            : None
tables                : 3.9.2
tabulate              : None
xarray                : None
xlrd                  : None
zstandard             : None
tzdata                : 2023.4
qtpy                  : None
pyqt5                 : None

</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57192/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57192/timeline,,
20,https://api.github.com/repos/pandas-dev/pandas/issues/57191,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57191/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57191/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57191/events,https://github.com/pandas-dev/pandas/issues/57191,2111600616,I_kwDOAA0YD8593Hfo,57191,ENH: deprecate reading from clipboard only supports utf-8 encoding,"{'login': 'PaleNeutron', 'id': 8296331, 'node_id': 'MDQ6VXNlcjgyOTYzMzE=', 'avatar_url': 'https://avatars.githubusercontent.com/u/8296331?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/PaleNeutron', 'html_url': 'https://github.com/PaleNeutron', 'followers_url': 'https://api.github.com/users/PaleNeutron/followers', 'following_url': 'https://api.github.com/users/PaleNeutron/following{/other_user}', 'gists_url': 'https://api.github.com/users/PaleNeutron/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/PaleNeutron/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/PaleNeutron/subscriptions', 'organizations_url': 'https://api.github.com/users/PaleNeutron/orgs', 'repos_url': 'https://api.github.com/users/PaleNeutron/repos', 'events_url': 'https://api.github.com/users/PaleNeutron/events{/privacy}', 'received_events_url': 'https://api.github.com/users/PaleNeutron/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76812, 'node_id': 'MDU6TGFiZWw3NjgxMg==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Enhancement', 'name': 'Enhancement', 'color': '4E9A06', 'default': False, 'description': None}, {'id': 1954720290, 'node_id': 'MDU6TGFiZWwxOTU0NzIwMjkw', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Triage', 'name': 'Needs Triage', 'color': '0052cc', 'default': False, 'description': 'Issue that has not been reviewed by a pandas team member'}]",open,False,,[],,0,2024-02-01T05:41:04Z,2024-02-01T05:47:52Z,,NONE,,,,"### Feature Type

- [ ] Adding new functionality to pandas

- [X] Changing existing functionality in pandas

- [ ] Removing existing functionality in pandas


### Problem Description

Code following will raise `NotImplementedError: reading from clipboard only supports utf-8 encoding`

```python
df = pd.read_clipboard(encoding=""gbk"")
```

BUT, if user do it with:

```python
pd.io.clipboard.ENCODING = ""gbk""
df = pd.read_clipboard()
pd.io.clipboard.ENCODING = ""utf8""
```

It works well.

### Feature Description

I am not sure why `encoding` in pandas is fixed to 'utf8', but in wsl2 user's windows system default encoding is usually not Unicode and very hard to migrate this settings.

Allow user change encoding of `read_clipboard` will be very helpful.

### Alternative Solutions

```python
pd.io.clipboard.ENCODING = ""gbk""
df = pd.read_clipboard()
pd.io.clipboard.ENCODING = ""utf8""
```

### Additional Context

data for testting: 

è¿™ | 1
-- | --
æ˜¯ | 2
ä¸€ | 3
ä¸ª | 4
è¡¨ | 5


```
# stdout[:-2]
data = b'\xd5\xe2\t1\r\n\xca\xc7\t2\r\n\xd2\xbb\t3\r\n\xb8\xf6\t4\r\n\xb1\xed\t5\r\n'
```




















































","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57191/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57191/timeline,,
21,https://api.github.com/repos/pandas-dev/pandas/issues/57189,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57189/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57189/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57189/events,https://github.com/pandas-dev/pandas/issues/57189,2111162868,I_kwDOAA0YD8591cn0,57189,BUG: Series.map() coerces Int64Dtype and int64[pyarrow] series which contain missing values to float64,"{'login': 'weltenseglr', 'id': 19477864, 'node_id': 'MDQ6VXNlcjE5NDc3ODY0', 'avatar_url': 'https://avatars.githubusercontent.com/u/19477864?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/weltenseglr', 'html_url': 'https://github.com/weltenseglr', 'followers_url': 'https://api.github.com/users/weltenseglr/followers', 'following_url': 'https://api.github.com/users/weltenseglr/following{/other_user}', 'gists_url': 'https://api.github.com/users/weltenseglr/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/weltenseglr/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/weltenseglr/subscriptions', 'organizations_url': 'https://api.github.com/users/weltenseglr/orgs', 'repos_url': 'https://api.github.com/users/weltenseglr/repos', 'events_url': 'https://api.github.com/users/weltenseglr/events{/privacy}', 'received_events_url': 'https://api.github.com/users/weltenseglr/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 1817503692, 'node_id': 'MDU6TGFiZWwxODE3NTAzNjky', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/NA%20-%20MaskedArrays', 'name': 'NA - MaskedArrays', 'color': '8cc645', 'default': False, 'description': 'Related to pd.NA and nullable extension arrays'}, {'id': 3303158446, 'node_id': 'MDU6TGFiZWwzMzAzMTU4NDQ2', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Arrow', 'name': 'Arrow', 'color': 'f9d0c4', 'default': False, 'description': 'pyarrow functionality'}]",open,False,"{'login': 'remiBoudreau', 'id': 41983349, 'node_id': 'MDQ6VXNlcjQxOTgzMzQ5', 'avatar_url': 'https://avatars.githubusercontent.com/u/41983349?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/remiBoudreau', 'html_url': 'https://github.com/remiBoudreau', 'followers_url': 'https://api.github.com/users/remiBoudreau/followers', 'following_url': 'https://api.github.com/users/remiBoudreau/following{/other_user}', 'gists_url': 'https://api.github.com/users/remiBoudreau/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/remiBoudreau/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/remiBoudreau/subscriptions', 'organizations_url': 'https://api.github.com/users/remiBoudreau/orgs', 'repos_url': 'https://api.github.com/users/remiBoudreau/repos', 'events_url': 'https://api.github.com/users/remiBoudreau/events{/privacy}', 'received_events_url': 'https://api.github.com/users/remiBoudreau/received_events', 'type': 'User', 'site_admin': False}","[{'login': 'remiBoudreau', 'id': 41983349, 'node_id': 'MDQ6VXNlcjQxOTgzMzQ5', 'avatar_url': 'https://avatars.githubusercontent.com/u/41983349?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/remiBoudreau', 'html_url': 'https://github.com/remiBoudreau', 'followers_url': 'https://api.github.com/users/remiBoudreau/followers', 'following_url': 'https://api.github.com/users/remiBoudreau/following{/other_user}', 'gists_url': 'https://api.github.com/users/remiBoudreau/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/remiBoudreau/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/remiBoudreau/subscriptions', 'organizations_url': 'https://api.github.com/users/remiBoudreau/orgs', 'repos_url': 'https://api.github.com/users/remiBoudreau/repos', 'events_url': 'https://api.github.com/users/remiBoudreau/events{/privacy}', 'received_events_url': 'https://api.github.com/users/remiBoudreau/received_events', 'type': 'User', 'site_admin': False}]",,6,2024-01-31T23:26:59Z,2024-02-02T09:21:57Z,,NONE,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [X] I have confirmed this bug exists on the [main branch](https://pandas.pydata.org/docs/dev/getting_started/install.html#installing-the-development-version-of-pandas) of pandas.


### Reproducible Example

```python
import pandas as pd
import pyarrow as pa

ser1 = pd.Series([1,2,3,None,10], dtype=pd.Int64Dtype())
ser2 = pd.Series([1,2,3,pd.NA,10], dtype=pd.Int64Dtype())
ser3 = pd.Series([1,2,3,pd.NA,10], dtype=pd.ArrowDtype(pa.int64()))

for ser in ser1, ser2, ser3:
    print(f""initial dtype: {ser.dtype}"")
    ser_mapped = ser.map(lambda x: x)
    print(f""post map dtype: {ser_mapped.dtype}"")
    ser_filtered = ser.dropna().map(lambda x: x)
    print(f""dropna map dtype: {ser_mapped.dtype}"")

ser2.map(type)
ser2.dropna().map(type)

""""""
output:

for ser1:
initial dtype: Int64
post map dtype: float64
dropna map dtype: float64

for ser2:
initial dtype: Int64
post map dtype: float64
dropna map dtype: float64

for ser3:
initial dtype: int64[pyarrow]
post map dtype: float64
dropna map dtype: float64


""""""
```


### Issue Description

Using map on a Series with dtype Int64Dtype or int64[dtype] will coerce values to float if it contains any missing values.

```
>>> ser2.map(type)
0    <class 'float'>
1    <class 'float'>
2    <class 'float'>
3    <class 'float'>
4    <class 'float'>
dtype: object
>>> ser2.dropna().map(type)
0    <class 'int'>
1    <class 'int'>
2    <class 'int'>
4    <class 'int'>
dtype: object
```

### Expected Behavior
Series.map() should not coerce into float64 with these dtypes.

As stated in the documentation on [working with missing data](https://pandas.pydata.org/docs/user_guide/missing_data.html#values-considered-missing):

> [NA](https://pandas.pydata.org/docs/reference/api/pandas.NA.html#pandas.NA) for [StringDtype](https://pandas.pydata.org/docs/reference/api/pandas.StringDtype.html#pandas.StringDtype), [Int64Dtype](https://pandas.pydata.org/docs/reference/api/pandas.Int64Dtype.html#pandas.Int64Dtype) (and other bit widths), Float64Dtype`(and other bit widths), :class:`BooleanDtype and [ArrowDtype](https://pandas.pydata.org/docs/reference/api/pandas.ArrowDtype.html#pandas.ArrowDtype). **These types will maintain the original data type of the data.**



### Installed Versions

<details>

>>> pd.show_versions()
/usr/lib/python3.12/site-packages/_distutils_hack/__init__.py:33: UserWarning: Setuptools is replacing distutils.
  warnings.warn(""Setuptools is replacing distutils."")

INSTALLED VERSIONS
------------------
commit                : db11e25d2b1175fdf85d963a88ff5a1d4bdb6fd8
python                : 3.12.1.final.0
python-bits           : 64
OS                    : Linux
OS-release            : 6.6.13-200.fc39.x86_64
Version               : #1 SMP PREEMPT_DYNAMIC Sat Jan 20 18:03:28 UTC 2024
machine               : x86_64
processor             : 
byteorder             : little
LC_ALL                : None
LANG                  : en_IE.UTF-8
LOCALE                : en_IE.UTF-8

pandas                : 3.0.0.dev0+197.gdb11e25d2b
numpy                 : 1.26.3
pytz                  : 2023.3.post1
dateutil              : 2.8.2
setuptools            : 67.7.2
pip                   : 23.2.1
Cython                : None
pytest                : 7.4.3
hypothesis            : None
sphinx                : 7.2.6
blosc                 : None
feather               : None
xlsxwriter            : None
lxml.etree            : 5.0.0
html5lib              : None
pymysql               : None
psycopg2              : None
jinja2                : 3.1.2
IPython               : 8.19.0
pandas_datareader     : None
adbc-driver-postgresql: None
adbc-driver-sqlite    : None
bs4                   : None
bottleneck            : None
dataframe-api-compat  : None
fastparquet           : None
fsspec                : None
gcsfs                 : None
matplotlib            : None
numba                 : None
numexpr               : None
odfpy                 : None
openpyxl              : None
pandas_gbq            : None
pyarrow               : 15.0.0
pyreadstat            : None
python-calamine       : None
pyxlsb                : None
s3fs                  : None
scipy                 : None
sqlalchemy            : None
tables                : None
tabulate              : None
xarray                : None
xlrd                  : None
zstandard             : None
tzdata                : 2023.4
qtpy                  : None
pyqt5                 : None


</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57189/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57189/timeline,,
22,https://api.github.com/repos/pandas-dev/pandas/issues/57188,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57188/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57188/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57188/events,https://github.com/pandas-dev/pandas/issues/57188,2111108717,I_kwDOAA0YD8591PZt,57188,ENH: align timedelta fractional seconds,"{'login': 'wjandrea', 'id': 22385371, 'node_id': 'MDQ6VXNlcjIyMzg1Mzcx', 'avatar_url': 'https://avatars.githubusercontent.com/u/22385371?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/wjandrea', 'html_url': 'https://github.com/wjandrea', 'followers_url': 'https://api.github.com/users/wjandrea/followers', 'following_url': 'https://api.github.com/users/wjandrea/following{/other_user}', 'gists_url': 'https://api.github.com/users/wjandrea/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/wjandrea/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/wjandrea/subscriptions', 'organizations_url': 'https://api.github.com/users/wjandrea/orgs', 'repos_url': 'https://api.github.com/users/wjandrea/repos', 'events_url': 'https://api.github.com/users/wjandrea/events{/privacy}', 'received_events_url': 'https://api.github.com/users/wjandrea/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76812, 'node_id': 'MDU6TGFiZWw3NjgxMg==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Enhancement', 'name': 'Enhancement', 'color': '4E9A06', 'default': False, 'description': None}, {'id': 13101118, 'node_id': 'MDU6TGFiZWwxMzEwMTExOA==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Output-Formatting', 'name': 'Output-Formatting', 'color': 'ededed', 'default': False, 'description': '__repr__ of pandas objects, to_string'}, {'id': 49597148, 'node_id': 'MDU6TGFiZWw0OTU5NzE0OA==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Timedelta', 'name': 'Timedelta', 'color': '5319e7', 'default': False, 'description': 'Timedelta data type'}]",open,False,,[],,2,2024-01-31T22:42:03Z,2024-02-02T04:14:29Z,,CONTRIBUTOR,,,,"### Feature Type

- [X] Adding new functionality to pandas

- [ ] Changing existing functionality in pandas

- [ ] Removing existing functionality in pandas


### Problem Description

It's hard to read a column of timedeltas with fractional seconds of different precisions because it's not aligned, for example:
```
0             0 days 00:00:01
1      0 days 00:00:00.500000
2   0 days 00:00:00.333333333
dtype: timedelta64[ns]
```

It'd be easier to read like this:
```
0   0 days 00:00:01
1   0 days 00:00:00.500000
2   0 days 00:00:00.333333333
dtype: timedelta64[ns]
```
or
```
0   0 days 00:00:01.000000000
1   0 days 00:00:00.500000000
2   0 days 00:00:00.333333333
dtype: timedelta64[ns]
```

To reproduce:
```python
s = 1 / pd.Series(np.arange(3)+1)
td = pd.to_timedelta(s, unit='s')
td
```

### Feature Description

Add padding on the right.

In this case, it can be done by left-justifying to the largest size:
```python
n = td.astype(str).apply(len).max()
td.astype(str).str.ljust(n)
```
```
0    0 days 00:00:01          
1    0 days 00:00:00.500000   
2    0 days 00:00:00.333333333
dtype: object
```
But of course, this wouldn't work for different numbers of days. For example:
```python
td1 = pd.concat([td, pd.Series(pd.Timedelta(days=4000))])
```
```
0    0 days 00:00:01          
1    0 days 00:00:00.500000   
2    0 days 00:00:00.333333333
0    4000 days 00:00:00       
dtype: object
```
If timedeltas had a `.replace()` method so you could zero out the days, then it would work, but AFAIK such a method doesn't exist.

BTW, the same thing is already implemented for floats and datetimes.
```python
>>> s*10
0    10.000000
1     5.000000
2     3.333333
dtype: float64
>>> pd.Timestamp(0) + td
0   1970-01-01 00:00:01.000000000
1   1970-01-01 00:00:00.500000000
2   1970-01-01 00:00:00.333333333
dtype: datetime64[ns]
```

### Alternative Solutions

n/a

### Additional Context

_No response_","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57188/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57188/timeline,,
23,https://api.github.com/repos/pandas-dev/pandas/issues/57184,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57184/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57184/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57184/events,https://github.com/pandas-dev/pandas/pull/57184,2110992084,PR_kwDOAA0YD85lnmxW,57184,Use ruff to detect banned import,"{'login': 'tqa236', 'id': 25203655, 'node_id': 'MDQ6VXNlcjI1MjAzNjU1', 'avatar_url': 'https://avatars.githubusercontent.com/u/25203655?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/tqa236', 'html_url': 'https://github.com/tqa236', 'followers_url': 'https://api.github.com/users/tqa236/followers', 'following_url': 'https://api.github.com/users/tqa236/following{/other_user}', 'gists_url': 'https://api.github.com/users/tqa236/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/tqa236/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/tqa236/subscriptions', 'organizations_url': 'https://api.github.com/users/tqa236/orgs', 'repos_url': 'https://api.github.com/users/tqa236/repos', 'events_url': 'https://api.github.com/users/tqa236/events{/privacy}', 'received_events_url': 'https://api.github.com/users/tqa236/received_events', 'type': 'User', 'site_admin': False}","[{'id': 106935113, 'node_id': 'MDU6TGFiZWwxMDY5MzUxMTM=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Code%20Style', 'name': 'Code Style', 'color': 'eb6420', 'default': False, 'description': 'Code style, linting, code_checks'}]",open,False,,[],,0,2024-01-31T21:22:40Z,2024-02-03T22:37:29Z,,CONTRIBUTOR,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/57184', 'html_url': 'https://github.com/pandas-dev/pandas/pull/57184', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/57184.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/57184.patch', 'merged_at': None}","There are several other potential replacement, I just open this PR first to check if this replacement is good or not. The newly added `noqa` in `pandas/io/common.py` shows that the check works.

- [ ] closes #xxxx (Replace xxxx with the GitHub issue number)
- [ ] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [ ] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
- [ ] Added [type annotations](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#type-hints) to new arguments/methods/functions.
- [ ] Added an entry in the latest `doc/source/whatsnew/vX.X.X.rst` file if fixing a bug or adding a new feature.
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57184/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57184/timeline,,
24,https://api.github.com/repos/pandas-dev/pandas/issues/57182,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57182/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57182/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57182/events,https://github.com/pandas-dev/pandas/pull/57182,2110869914,PR_kwDOAA0YD85lnMPF,57182,Bump ruff to version 0.2.0,"{'login': 'tqa236', 'id': 25203655, 'node_id': 'MDQ6VXNlcjI1MjAzNjU1', 'avatar_url': 'https://avatars.githubusercontent.com/u/25203655?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/tqa236', 'html_url': 'https://github.com/tqa236', 'followers_url': 'https://api.github.com/users/tqa236/followers', 'following_url': 'https://api.github.com/users/tqa236/following{/other_user}', 'gists_url': 'https://api.github.com/users/tqa236/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/tqa236/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/tqa236/subscriptions', 'organizations_url': 'https://api.github.com/users/tqa236/orgs', 'repos_url': 'https://api.github.com/users/tqa236/repos', 'events_url': 'https://api.github.com/users/tqa236/events{/privacy}', 'received_events_url': 'https://api.github.com/users/tqa236/received_events', 'type': 'User', 'site_admin': False}","[{'id': 106935113, 'node_id': 'MDU6TGFiZWwxMDY5MzUxMTM=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Code%20Style', 'name': 'Code Style', 'color': 'eb6420', 'default': False, 'description': 'Code style, linting, code_checks'}]",open,False,,[],,3,2024-01-31T20:03:19Z,2024-02-02T00:05:13Z,,CONTRIBUTOR,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/57182', 'html_url': 'https://github.com/pandas-dev/pandas/pull/57182', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/57182.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/57182.patch', 'merged_at': None}","Hi @mroeschke, while looking into the `pylint` rule, I noticed that most of them are currently gated behind the `preview` flag. Do you think we should enable the `preview` flag or wait some rules to be promoted to stable in `ruff==0.2.0` (should be released in the next few weeks)

Other than that, this PR is ready for review.

- [ ] closes #xxxx (Replace xxxx with the GitHub issue number)
- [ ] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [ ] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
- [ ] Added [type annotations](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#type-hints) to new arguments/methods/functions.
- [ ] Added an entry in the latest `doc/source/whatsnew/vX.X.X.rst` file if fixing a bug or adding a new feature.
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57182/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57182/timeline,,
25,https://api.github.com/repos/pandas-dev/pandas/issues/57178,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57178/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57178/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57178/events,https://github.com/pandas-dev/pandas/issues/57178,2110602795,I_kwDOAA0YD859zT4r,57178,ENH: Not silently ignore violation of minimal required version of SQLAlchemy,"{'login': 'bebach', 'id': 145982645, 'node_id': 'U_kgDOCLOEtQ', 'avatar_url': 'https://avatars.githubusercontent.com/u/145982645?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/bebach', 'html_url': 'https://github.com/bebach', 'followers_url': 'https://api.github.com/users/bebach/followers', 'following_url': 'https://api.github.com/users/bebach/following{/other_user}', 'gists_url': 'https://api.github.com/users/bebach/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/bebach/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/bebach/subscriptions', 'organizations_url': 'https://api.github.com/users/bebach/orgs', 'repos_url': 'https://api.github.com/users/bebach/repos', 'events_url': 'https://api.github.com/users/bebach/events{/privacy}', 'received_events_url': 'https://api.github.com/users/bebach/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76812, 'node_id': 'MDU6TGFiZWw3NjgxMg==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Enhancement', 'name': 'Enhancement', 'color': '4E9A06', 'default': False, 'description': None}, {'id': 47232590, 'node_id': 'MDU6TGFiZWw0NzIzMjU5MA==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/IO%20SQL', 'name': 'IO SQL', 'color': '5319e7', 'default': False, 'description': 'to_sql, read_sql, read_sql_query'}, {'id': 527603109, 'node_id': 'MDU6TGFiZWw1Mjc2MDMxMDk=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Dependencies', 'name': 'Dependencies', 'color': 'd93f0b', 'default': False, 'description': 'Required and optional dependencies'}]",open,False,,[],,4,2024-01-31T17:21:53Z,2024-02-03T03:47:29Z,,NONE,,,,"### Feature Type

- [ ] Adding new functionality to pandas

- [X] Changing existing functionality in pandas

- [ ] Removing existing functionality in pandas


### Problem Description

#### Observation
After upgrading to Pandas 2.2.0 calling `read_sql_query` with a SQLAlchemy query on an SQLAlchemy connection yielded `""Query must be a string unless using sqlalchemy.""` without any indication why or what may have broken with the upgrade.

#### Analysis
Tracking the problem down it was found that `pandasSQL_builder` [(code)](https://github.com/pandas-dev/pandas/blob/f538741432edf55c6b9fb5d0d496d2dd1d7c2457/pandas/io/sql.py#L900) calls `sqlalchemy = import_optional_dependency(""sqlalchemy"", errors=""ignore"")` to resolve the optional SQLAlchemy package (which was installed in my case)

Due to `errors=""ignore""` the violation of the minimal required version for SQLAlchemy does not lead to a warn or raise [(code)](https://github.com/pandas-dev/pandas/blob/f538741432edf55c6b9fb5d0d496d2dd1d7c2457/pandas/compat/_optional.py#L156) but just silently returns with `None`.

This in turn lets `pandasSQL_builder` silently default to `SQLiteDatabase(con)`.

### Feature Description

#### Proposed improvement

Do not ignore the minimal version violation in `import_optional_dependency` in this context but make it obvious. For example by introducing an additional ""errors""-mode like `import_optional_dependency(""sqlalchemy"", errors=""raise-on-version-violation"")`.

### Alternative Solutions

./.

### Additional Context

_No response_","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57178/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57178/timeline,,
26,https://api.github.com/repos/pandas-dev/pandas/issues/57177,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57177/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57177/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57177/events,https://github.com/pandas-dev/pandas/issues/57177,2110496397,I_kwDOAA0YD859y56N,57177,"ENH: Expose integer formatting also for default display, not only styler","{'login': 'enryH', 'id': 2833836, 'node_id': 'MDQ6VXNlcjI4MzM4MzY=', 'avatar_url': 'https://avatars.githubusercontent.com/u/2833836?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/enryH', 'html_url': 'https://github.com/enryH', 'followers_url': 'https://api.github.com/users/enryH/followers', 'following_url': 'https://api.github.com/users/enryH/following{/other_user}', 'gists_url': 'https://api.github.com/users/enryH/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/enryH/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/enryH/subscriptions', 'organizations_url': 'https://api.github.com/users/enryH/orgs', 'repos_url': 'https://api.github.com/users/enryH/repos', 'events_url': 'https://api.github.com/users/enryH/events{/privacy}', 'received_events_url': 'https://api.github.com/users/enryH/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76812, 'node_id': 'MDU6TGFiZWw3NjgxMg==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Enhancement', 'name': 'Enhancement', 'color': '4E9A06', 'default': False, 'description': None}, {'id': 13101118, 'node_id': 'MDU6TGFiZWwxMzEwMTExOA==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Output-Formatting', 'name': 'Output-Formatting', 'color': 'ededed', 'default': False, 'description': '__repr__ of pandas objects, to_string'}, {'id': 219960758, 'node_id': 'MDU6TGFiZWwyMTk5NjA3NTg=', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Needs%20Discussion', 'name': 'Needs Discussion', 'color': '207de5', 'default': False, 'description': 'Requires discussion from core team before further action'}]",open,False,"{'login': 'Meadiocre', 'id': 70726252, 'node_id': 'MDQ6VXNlcjcwNzI2MjUy', 'avatar_url': 'https://avatars.githubusercontent.com/u/70726252?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/Meadiocre', 'html_url': 'https://github.com/Meadiocre', 'followers_url': 'https://api.github.com/users/Meadiocre/followers', 'following_url': 'https://api.github.com/users/Meadiocre/following{/other_user}', 'gists_url': 'https://api.github.com/users/Meadiocre/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/Meadiocre/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/Meadiocre/subscriptions', 'organizations_url': 'https://api.github.com/users/Meadiocre/orgs', 'repos_url': 'https://api.github.com/users/Meadiocre/repos', 'events_url': 'https://api.github.com/users/Meadiocre/events{/privacy}', 'received_events_url': 'https://api.github.com/users/Meadiocre/received_events', 'type': 'User', 'site_admin': False}","[{'login': 'Meadiocre', 'id': 70726252, 'node_id': 'MDQ6VXNlcjcwNzI2MjUy', 'avatar_url': 'https://avatars.githubusercontent.com/u/70726252?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/Meadiocre', 'html_url': 'https://github.com/Meadiocre', 'followers_url': 'https://api.github.com/users/Meadiocre/followers', 'following_url': 'https://api.github.com/users/Meadiocre/following{/other_user}', 'gists_url': 'https://api.github.com/users/Meadiocre/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/Meadiocre/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/Meadiocre/subscriptions', 'organizations_url': 'https://api.github.com/users/Meadiocre/orgs', 'repos_url': 'https://api.github.com/users/Meadiocre/repos', 'events_url': 'https://api.github.com/users/Meadiocre/events{/privacy}', 'received_events_url': 'https://api.github.com/users/Meadiocre/received_events', 'type': 'User', 'site_admin': False}]",,8,2024-01-31T16:29:42Z,2024-02-04T01:04:51Z,,CONTRIBUTOR,,,,"### Feature Type

- [X] Adding new functionality to pandas

- [ ] Changing existing functionality in pandas

- [ ] Removing existing functionality in pandas


### Problem Description

I noticed that in Pandas version `2.2` the internal implementation of  `IntArrayFormatter` was changed (or at least renamed), marking the classes as private using one underscore. I used the implementation as described [here](https://stackoverflow.com/a/29663750/9684872) to format integers in a DataFrame on each display.

See changes between `2.1` and `2.2` to make the linked patch work: [link](https://github.com/RasmussenLab/njab/pull/4/commits/10b0c84ddb28a1dd9c2bd58e9b6af148dbd6c9dc)

I see that the styler supports formatting thousands:

```python
import pandas as pd
pd.options.styler.format.thousands = ','
s = pd.Series([1_000_000]).to_frame()
s.style # does change display of s to 1,000,000
```
however
```
s # will display 1000000
```
Would it be possible to add the same to the display options?

### Feature Description

pd.options.format.thousands = ','

would need to pass:

```python
if pd.options.format.thousands:
  format_str = f':{pd.options.format.thousands}d'.format
else:
  format_str = ':d'.format
```



### Alternative Solutions

Change the default [here](https://github.com/pandas-dev/pandas/blob/main/pandas/io/formats/format.py#L1475)

```python
class IntArrayFormatter(pf._GenericArrayFormatter):

    def _format_strings(self):
        formatter = self.formatter or '{:,d}'.format
        fmt_values = [formatter(x) for x in self.values]
        return fmt_values

pf._IntArrayFormatter = IntArrayFormatter
```

Using the above patch I get the display I would prefer:

```
>>> pd.Series([1_000_000])
0    1,000,000
dtype: int64
```

### Additional Context

Working with large integers in tables is made easier if thousands are visually distinguished. Maybe there is already a way to specify that formatter function (`str.format`) for display, which would be perfect.","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57177/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57177/timeline,,
27,https://api.github.com/repos/pandas-dev/pandas/issues/57172,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57172/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57172/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57172/events,https://github.com/pandas-dev/pandas/pull/57172,2110147542,PR_kwDOAA0YD85lks5n,57172,MAINT: Adjust the codebase to the new `np.array`'s `copy` keyword meaning,"{'login': 'mtsokol', 'id': 8431159, 'node_id': 'MDQ6VXNlcjg0MzExNTk=', 'avatar_url': 'https://avatars.githubusercontent.com/u/8431159?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/mtsokol', 'html_url': 'https://github.com/mtsokol', 'followers_url': 'https://api.github.com/users/mtsokol/followers', 'following_url': 'https://api.github.com/users/mtsokol/following{/other_user}', 'gists_url': 'https://api.github.com/users/mtsokol/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/mtsokol/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/mtsokol/subscriptions', 'organizations_url': 'https://api.github.com/users/mtsokol/orgs', 'repos_url': 'https://api.github.com/users/mtsokol/repos', 'events_url': 'https://api.github.com/users/mtsokol/events{/privacy}', 'received_events_url': 'https://api.github.com/users/mtsokol/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76865106, 'node_id': 'MDU6TGFiZWw3Njg2NTEwNg==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Compat', 'name': 'Compat', 'color': '0052cc', 'default': False, 'description': 'pandas objects compatability with Numpy or Python functions'}]",open,False,,[],"{'url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/116', 'html_url': 'https://github.com/pandas-dev/pandas/milestone/116', 'labels_url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/116/labels', 'id': 10403366, 'node_id': 'MI_kwDOAA0YD84Anr4m', 'number': 116, 'title': '2.2.1', 'description': 'on-merge: backport to 2.2.x', 'creator': {'login': 'lithomas1', 'id': 47963215, 'node_id': 'MDQ6VXNlcjQ3OTYzMjE1', 'avatar_url': 'https://avatars.githubusercontent.com/u/47963215?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/lithomas1', 'html_url': 'https://github.com/lithomas1', 'followers_url': 'https://api.github.com/users/lithomas1/followers', 'following_url': 'https://api.github.com/users/lithomas1/following{/other_user}', 'gists_url': 'https://api.github.com/users/lithomas1/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/lithomas1/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/lithomas1/subscriptions', 'organizations_url': 'https://api.github.com/users/lithomas1/orgs', 'repos_url': 'https://api.github.com/users/lithomas1/repos', 'events_url': 'https://api.github.com/users/lithomas1/events{/privacy}', 'received_events_url': 'https://api.github.com/users/lithomas1/received_events', 'type': 'User', 'site_admin': False}, 'open_issues': 41, 'closed_issues': 69, 'state': 'open', 'created_at': '2024-01-11T01:47:31Z', 'updated_at': '2024-02-04T03:08:15Z', 'due_on': None, 'closed_at': None}",0,2024-01-31T13:54:14Z,2024-02-01T17:17:54Z,,CONTRIBUTOR,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/57172', 'html_url': 'https://github.com/pandas-dev/pandas/pull/57172', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/57172.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/57172.patch', 'merged_at': None}","Hi! 

This PR addresses changes planned for NumPy in https://github.com/numpy/numpy/pull/25168 (new `copy` keyword for `np.asarray` and `np.array`).

`np.array(..., copy=False)` will now throw and exception if a copy is needed. To retain the same behavior `np.asarray(...)` can be used, so a copy is made only when needed.

I applied changes in a backward-compatible way, so that no NumPy version check & branching is needed.","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57172/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57172/timeline,,
28,https://api.github.com/repos/pandas-dev/pandas/issues/57171,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57171/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57171/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57171/events,https://github.com/pandas-dev/pandas/issues/57171,2110030660,I_kwDOAA0YD859xINE,57171,"BUG: does .any(axis=1, skipna=False) follow Kleene Logic?","{'login': 'MarcoGorelli', 'id': 33491632, 'node_id': 'MDQ6VXNlcjMzNDkxNjMy', 'avatar_url': 'https://avatars.githubusercontent.com/u/33491632?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/MarcoGorelli', 'html_url': 'https://github.com/MarcoGorelli', 'followers_url': 'https://api.github.com/users/MarcoGorelli/followers', 'following_url': 'https://api.github.com/users/MarcoGorelli/following{/other_user}', 'gists_url': 'https://api.github.com/users/MarcoGorelli/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/MarcoGorelli/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/MarcoGorelli/subscriptions', 'organizations_url': 'https://api.github.com/users/MarcoGorelli/orgs', 'repos_url': 'https://api.github.com/users/MarcoGorelli/repos', 'events_url': 'https://api.github.com/users/MarcoGorelli/events{/privacy}', 'received_events_url': 'https://api.github.com/users/MarcoGorelli/received_events', 'type': 'User', 'site_admin': False}","[{'id': 76811, 'node_id': 'MDU6TGFiZWw3NjgxMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Bug', 'name': 'Bug', 'color': 'e10c02', 'default': False, 'description': None}, {'id': 2365504383, 'node_id': 'MDU6TGFiZWwyMzY1NTA0Mzgz', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Reduction%20Operations', 'name': 'Reduction Operations', 'color': '547c03', 'default': False, 'description': 'sum, mean, min, max, etc.'}]",open,False,,[],,2,2024-01-31T12:52:14Z,2024-02-01T22:27:18Z,,MEMBER,,,,"### Pandas version checks

- [X] I have checked that this issue has not already been reported.

- [X] I have confirmed this bug exists on the [latest version](https://pandas.pydata.org/docs/whatsnew/index.html) of pandas.

- [X] I have confirmed this bug exists on the [main branch](https://pandas.pydata.org/docs/dev/getting_started/install.html#installing-the-development-version-of-pandas) of pandas.


### Reproducible Example

```python
In [16]: pd.DataFrame({
    ...:     'a': [True, False, None],
    ...:     'b': [None, None, None],
    ...: }, dtype='boolean[pyarrow]').any(axis=1, skipna=False)
Out[16]:
0     True  #
1    False  # <=== should be NA?
2    False  # <=== should be NA?
dtype: bool[pyarrow]


In [17]: pd.Series([False, None], dtype='boolean[pyarrow]').any(skipna=False)
Out[17]: <NA>

In [18]: pd.Series([None, None], dtype='boolean[pyarrow]').any(skipna=False)
Out[18]: <NA>

In [19]: pd.Series([True, None], dtype='boolean[pyarrow]').any(skipna=False)
Out[19]: True
```


### Issue Description

I don't really understand what's happening, nor what's meant to be happening

[The docs for `Series.any`](https://pandas.pydata.org/docs/reference/api/pandas.Series.any.html#pandas.Series.any) say

> If skipna is False, then NA are treated as True, because these are not equal to zero.

but that doesn't seem to be the case. If that was the case, then
```python
pd.Series([False, None], dtype='boolean[pyarrow]').any(skipna=False)
```
would return `True`?

Instead, it looks like `Series.any` follows Kleene Logic. Fair nuff - but then, `DataFrame.any(axis=1, skipna=False)` doesn't?

### Expected Behavior

I think I'd expect
```python
0     True
1     <NA>
2     <NA>
```
from the `DataFrame.any(axis=1, skipna=False)` example

### Installed Versions

<details>

INSTALLED VERSIONS
------------------
commit                : fd3f57170aa1af588ba877e8e28c158a20a4886d
python                : 3.10.12.final.0
python-bits           : 64
OS                    : Linux
OS-release            : 5.15.133.1-microsoft-standard-WSL2
Version               : #1 SMP Thu Oct 5 21:02:42 UTC 2023
machine               : x86_64
processor             : x86_64
byteorder             : little
LC_ALL                : None
LANG                  : en_GB.UTF-8
LOCALE                : en_GB.UTF-8

pandas                : 2.2.0
numpy                 : 1.26.3
pytz                  : 2023.3.post1
dateutil              : 2.8.2
setuptools            : 59.6.0
pip                   : 22.0.2
Cython                : None
pytest                : 7.4.4
hypothesis            : None
sphinx                : None
blosc                 : None
feather               : None
xlsxwriter            : None
lxml.etree            : None
html5lib              : None
pymysql               : None
psycopg2              : None
jinja2                : 3.1.2
IPython               : 8.19.0
pandas_datareader     : None
adbc-driver-postgresql: None
adbc-driver-sqlite    : None
bs4                   : 4.12.2
bottleneck            : None
dataframe-api-compat  : None
fastparquet           : None
fsspec                : 2023.12.2
gcsfs                 : 2023.12.2post1
matplotlib            : None
numba                 : None
numexpr               : None
odfpy                 : None
openpyxl              : None
pandas_gbq            : None
pyarrow               : 15.0.0
pyreadstat            : None
python-calamine       : None
pyxlsb                : None
s3fs                  : None
scipy                 : 1.11.4
sqlalchemy            : 2.0.25
tables                : None
tabulate              : 0.9.0
xarray                : None
xlrd                  : None
zstandard             : None
tzdata                : 2023.4
qtpy                  : None
pyqt5                 : None
</details>
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57171/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57171/timeline,,
29,https://api.github.com/repos/pandas-dev/pandas/issues/57170,https://api.github.com/repos/pandas-dev/pandas,https://api.github.com/repos/pandas-dev/pandas/issues/57170/labels{/name},https://api.github.com/repos/pandas-dev/pandas/issues/57170/comments,https://api.github.com/repos/pandas-dev/pandas/issues/57170/events,https://github.com/pandas-dev/pandas/pull/57170,2109994385,PR_kwDOAA0YD85lkLDb,57170,REGR: Series.astype raising TypeError when converting a pyarrow integer type with nulls to numpy float,"{'login': 'lukemanley', 'id': 8519523, 'node_id': 'MDQ6VXNlcjg1MTk1MjM=', 'avatar_url': 'https://avatars.githubusercontent.com/u/8519523?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/lukemanley', 'html_url': 'https://github.com/lukemanley', 'followers_url': 'https://api.github.com/users/lukemanley/followers', 'following_url': 'https://api.github.com/users/lukemanley/following{/other_user}', 'gists_url': 'https://api.github.com/users/lukemanley/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/lukemanley/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/lukemanley/subscriptions', 'organizations_url': 'https://api.github.com/users/lukemanley/orgs', 'repos_url': 'https://api.github.com/users/lukemanley/repos', 'events_url': 'https://api.github.com/users/lukemanley/events{/privacy}', 'received_events_url': 'https://api.github.com/users/lukemanley/received_events', 'type': 'User', 'site_admin': False}","[{'id': 31404521, 'node_id': 'MDU6TGFiZWwzMTQwNDUyMQ==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Dtype%20Conversions', 'name': 'Dtype Conversions', 'color': 'e102d8', 'default': False, 'description': 'Unexpected or buggy dtype conversions'}, {'id': 32815646, 'node_id': 'MDU6TGFiZWwzMjgxNTY0Ng==', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Regression', 'name': 'Regression', 'color': 'e11d21', 'default': False, 'description': 'Functionality that used to work in a prior pandas version'}, {'id': 3303158446, 'node_id': 'MDU6TGFiZWwzMzAzMTU4NDQ2', 'url': 'https://api.github.com/repos/pandas-dev/pandas/labels/Arrow', 'name': 'Arrow', 'color': 'f9d0c4', 'default': False, 'description': 'pyarrow functionality'}]",open,False,,[],"{'url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/116', 'html_url': 'https://github.com/pandas-dev/pandas/milestone/116', 'labels_url': 'https://api.github.com/repos/pandas-dev/pandas/milestones/116/labels', 'id': 10403366, 'node_id': 'MI_kwDOAA0YD84Anr4m', 'number': 116, 'title': '2.2.1', 'description': 'on-merge: backport to 2.2.x', 'creator': {'login': 'lithomas1', 'id': 47963215, 'node_id': 'MDQ6VXNlcjQ3OTYzMjE1', 'avatar_url': 'https://avatars.githubusercontent.com/u/47963215?v=4', 'gravatar_id': '', 'url': 'https://api.github.com/users/lithomas1', 'html_url': 'https://github.com/lithomas1', 'followers_url': 'https://api.github.com/users/lithomas1/followers', 'following_url': 'https://api.github.com/users/lithomas1/following{/other_user}', 'gists_url': 'https://api.github.com/users/lithomas1/gists{/gist_id}', 'starred_url': 'https://api.github.com/users/lithomas1/starred{/owner}{/repo}', 'subscriptions_url': 'https://api.github.com/users/lithomas1/subscriptions', 'organizations_url': 'https://api.github.com/users/lithomas1/orgs', 'repos_url': 'https://api.github.com/users/lithomas1/repos', 'events_url': 'https://api.github.com/users/lithomas1/events{/privacy}', 'received_events_url': 'https://api.github.com/users/lithomas1/received_events', 'type': 'User', 'site_admin': False}, 'open_issues': 41, 'closed_issues': 69, 'state': 'open', 'created_at': '2024-01-11T01:47:31Z', 'updated_at': '2024-02-04T03:08:15Z', 'due_on': None, 'closed_at': None}",0,2024-01-31T12:31:12Z,2024-02-01T17:19:09Z,,MEMBER,,False,"{'url': 'https://api.github.com/repos/pandas-dev/pandas/pulls/57170', 'html_url': 'https://github.com/pandas-dev/pandas/pull/57170', 'diff_url': 'https://github.com/pandas-dev/pandas/pull/57170.diff', 'patch_url': 'https://github.com/pandas-dev/pandas/pull/57170.patch', 'merged_at': None}","- [x] closes #57093
- [x] [Tests added and passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#writing-tests) if fixing a bug or adding a new feature
- [x] All [code checks passed](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#pre-commit).
- [x] Added [type annotations](https://pandas.pydata.org/pandas-docs/dev/development/contributing_codebase.html#type-hints) to new arguments/methods/functions.
- [x] Added an entry in the latest `doc/source/whatsnew/v2.2.1.rst` file if fixing a bug or adding a new feature.
","{'url': 'https://api.github.com/repos/pandas-dev/pandas/issues/57170/reactions', 'total_count': 0, '+1': 0, '-1': 0, 'laugh': 0, 'hooray': 0, 'confused': 0, 'heart': 0, 'rocket': 0, 'eyes': 0}",https://api.github.com/repos/pandas-dev/pandas/issues/57170/timeline,,
